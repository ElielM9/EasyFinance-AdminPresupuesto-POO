const expensesList=document.querySelector("#expensesList");let budget;function startApp(){requestName(),requestBudget(),budgetFormEvents()}document.addEventListener("DOMContentLoaded",startApp);class Budget{constructor(e){this.budgetTotal=e,this.budgetAvailable=e,this.budgetSpent=0,this.expenses=[]}newExpenses(e){e.inputAmount>this.budgetAvailable?userInterface.printAlerts("No tienes fondos suficientes","error"):(this.expenses=[...this.expenses,e],this.calculateSpent(),userInterface.printAlerts("Se agregó correctamente","success"))}calculateSpent(){this.budgetSpent=this.expenses.reduce((e,t)=>e+t.inputAmount,0),this.budgetAvailable=this.budgetTotal-this.budgetSpent}deleteExpense(e){const t=this.expenses.filter(t=>t.id!==e);this.expenses=t,this.calculateSpent()}}class UserInterface{insertName(e){document.querySelector(".budget__heading--user-name").textContent=e+"!"}insertBudget(e){const{budgetTotal:t,budgetAvailable:n,budgetSpent:s}=e;let r=t.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),u=n.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),o=s.toLocaleString("es-MX",{style:"currency",currency:"MXN"});document.querySelector("#budgetCardTotal").textContent=""+r,document.querySelector("#budgetCardAvailable").textContent=""+u,document.querySelector("#budgetCardSpent").textContent=""+o}printAlerts(e,t){let n=document.querySelector(".alert--"+t);if(n)return void(n.textContent=e);const s=document.createElement("p");s.classList.add("alert"),"error"===t?s.classList.add("alert--error"):s.classList.add("alert--success"),s.textContent=e;document.querySelector("#budgetForm").appendChild(s),setTimeout(()=>{s.remove()},2e3)}showExpenseList(e){this.cleanHtml(),e.forEach(e=>{const{inputName:t,inputAmount:n,selectedCategory:s,id:r}=e,u=n.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),o=document.createElement("li");o.className="expense-item",o.dataset.id=r,o.dataset.category=s,o.innerHTML=`\n        <div class="expense-item__texts">\n          <p class="expense-item__description">${t}</p>\n          <p class="expense-item__price">${u}</p>\n        </div>\n      `;const c=document.createElement("button");c.classList.add("expense-item__btn"),c.textContent="X",c.addEventListener("click",()=>{deleteExpense(r)}),o.appendChild(c),expensesList.appendChild(o)})}cleanHtml(){for(;expensesList.firstChild;)expensesList.removeChild(expensesList.firstChild)}updateAvailableBudget(e,t){let n=e.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),s=t.toLocaleString("es-MX",{style:"currency",currency:"MXN"});document.querySelector("#budgetCardAvailable").textContent=""+n,document.querySelector("#budgetCardSpent").textContent=""+s}checkBudget(e){const{budgetTotal:t,budgetAvailable:n}=e,s=document.querySelector(".budget-form__btn");n<=0?(userInterface.printAlerts("El presupuesto se ha agotado","error"),s.disabled=!0):s.disabled=!1}}const userInterface=new UserInterface;function requestName(){let e;do{e=prompt("¿Cuál es tu nombre?"),e||alert("Por favor, introduce un nombre válido.")}while(!e);userInterface.insertName(e)}function requestBudget(){const e=Number(prompt("¿Cuál es tu presupuesto?"));(""===e||null===e||isNaN(e)||e<=0)&&window.location.reload(),budget=new Budget(e),userInterface.insertBudget(budget)}function budgetFormEvents(){document.querySelector("#budgetForm").addEventListener("submit",addExpense)}function addExpense(e){e.preventDefault();const t=document.querySelector("#budgetFormName").value,n=Number(document.querySelector("#budgetFormAmount").value),s=document.querySelector("#budgetFormCategory").value;if(""===t||""===n||""===s)return void userInterface.printAlerts("Todos los campos son obligatorios","error");if(n<=0||isNaN(n))return void userInterface.printAlerts("Cantidad no valida","error");const r={inputName:t,inputAmount:n,selectedCategory:s,id:Date.now()};budget.newExpenses(r);const{expenses:u,budgetAvailable:o,budgetSpent:c}=budget;userInterface.showExpenseList(u),userInterface.updateAvailableBudget(o,c),userInterface.checkBudget(budget);document.querySelector("#budgetForm").reset()}function deleteExpense(e){budget.deleteExpense(e);const{expenses:t,budgetAvailable:n,budgetSpent:s}=budget;userInterface.showExpenseList(t),userInterface.updateAvailableBudget(n,s),userInterface.checkBudget(budget)}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZXhwZW5zZXNMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYnVkZ2V0Iiwic3RhcnRBcHAiLCJyZXF1ZXN0TmFtZSIsInJlcXVlc3RCdWRnZXQiLCJidWRnZXRGb3JtRXZlbnRzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIkJ1ZGdldCIsIltvYmplY3QgT2JqZWN0XSIsImJ1ZGdldFRvdGFsIiwidGhpcyIsImJ1ZGdldEF2YWlsYWJsZSIsImJ1ZGdldFNwZW50IiwiZXhwZW5zZXMiLCJleHBlbnNlIiwiaW5wdXRBbW91bnQiLCJ1c2VySW50ZXJmYWNlIiwicHJpbnRBbGVydHMiLCJjYWxjdWxhdGVTcGVudCIsInJlZHVjZSIsInRvdGFsIiwiZXhwZW5zZUlkIiwiZmlsdGVyZWRFeHBlbnNlcyIsImZpbHRlciIsImlkIiwiVXNlckludGVyZmFjZSIsInVzZXJOYW1lIiwidGV4dENvbnRlbnQiLCJxdWFudGl0eSIsImZvcm1hdHRlZFRvdGFsIiwidG9Mb2NhbGVTdHJpbmciLCJzdHlsZSIsImN1cnJlbmN5IiwiZm9ybWF0dGVkQXZhaWxhYmxlIiwiZm9ybWF0dGVkU3BlbnQiLCJtZXNzYWdlIiwidHlwZUFsZXJ0IiwiZXhpc3RpbmdBbGVydCIsImFsZXJ0TWVzc2FnZSIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsInNldFRpbWVvdXQiLCJyZW1vdmUiLCJjbGVhbkh0bWwiLCJmb3JFYWNoIiwiaW5wdXROYW1lIiwic2VsZWN0ZWRDYXRlZ29yeSIsImZvcm1hdHRlZEFtb3VudCIsImV4cGVuc2VJdGVtIiwiY2xhc3NOYW1lIiwiZGF0YXNldCIsImNhdGVnb3J5IiwiaW5uZXJIVE1MIiwiZGVsZXRlQnRuIiwiZGVsZXRlRXhwZW5zZSIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsImF2YWlsYWJsZSIsInNwZW50IiwiYnVkZ2V0T2JqIiwiYnVkZ2V0Rm9ybUJ0biIsImRpc2FibGVkIiwicHJvbXB0IiwiYWxlcnQiLCJpbnNlcnROYW1lIiwidXNlckJ1ZGdldCIsIk51bWJlciIsImlzTmFOIiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJpbnNlcnRCdWRnZXQiLCJhZGRFeHBlbnNlIiwiZSIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJEYXRlIiwibm93IiwibmV3RXhwZW5zZXMiLCJzaG93RXhwZW5zZUxpc3QiLCJ1cGRhdGVBdmFpbGFibGVCdWRnZXQiLCJjaGVja0J1ZGdldCIsInJlc2V0Il0sIm1hcHBpbmdzIjoiQUFDQSxNQUFNQSxhQUFlQyxTQUFTQyxjQUFjLGlCQUM1QyxJQUFJQyxPQUtKLFNBQVNDLFdBQ1BDLGNBQ0FDLGdCQUNBQyxtQkFMRk4sU0FBU08saUJBQWlCLG1CQUFvQkosVUFTOUMsTUFBTUssT0FDSkMsWUFBWUMsR0FDVkMsS0FBS0QsWUFBY0EsRUFDbkJDLEtBQUtDLGdCQUFrQkYsRUFDdkJDLEtBQUtFLFlBQWMsRUFDbkJGLEtBQUtHLFNBQVcsR0FHbEJMLFlBQVlNLEdBRU5BLEVBQVFDLFlBQWNMLEtBQUtDLGdCQUM3QkssY0FBY0MsWUFBWSwrQkFBZ0MsVUFNNURQLEtBQUtHLFNBQVcsSUFBSUgsS0FBS0csU0FBVUMsR0FDbkNKLEtBQUtRLGlCQUdMRixjQUFjQyxZQUFZLDBCQUEyQixZQUd2RFQsaUJBQ0VFLEtBQUtFLFlBQWNGLEtBQUtHLFNBQVNNLE9BQy9CLENBQUNDLEVBQU9OLElBQVlNLEVBQVFOLEVBQVFDLFlBQ3BDLEdBRUZMLEtBQUtDLGdCQUFrQkQsS0FBS0QsWUFBY0MsS0FBS0UsWUFHakRKLGNBQWNhLEdBRVosTUFBTUMsRUFBbUJaLEtBQUtHLFNBQVNVLE9BQ3BDVCxHQUFZQSxFQUFRVSxLQUFPSCxHQUk5QlgsS0FBS0csU0FBV1MsRUFHaEJaLEtBQUtRLGtCQUlULE1BQU1PLGNBQ0pqQixXQUFXa0IsR0FDYzNCLFNBQVNDLGNBQzlCLCtCQUlhMkIsWUFBaUJELEVBQUgsSUFHL0JsQixhQUFhb0IsR0FDWCxNQUFN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QWMsZUFDL0JNLGlCQUFpQixTQUFVb0UsWUFHeEMsU0FBU0EsV0FBV0MsR0FDbEJBLEVBQUVDLGlCQUdGLE1BQU03QixFQUFZaEQsU0FBU0MsY0FBYyxtQkFBbUI2RSxNQUN0RDlELEVBQWNxRCxPQUFPckUsU0FBU0MsY0FBYyxxQkFBcUI2RSxPQUNqRTdCLEVBQW1CakQsU0FBU0MsY0FBYyx1QkFBdUI2RSxNQUl2RSxHQUhnQixLQUlkOUIsR0FKYyxLQUtkaEMsR0FMYyxLQU1kaUMsRUFJQSxZQUZBaEMsY0FBY0MsWUFBWSxvQ0FBcUMsU0FHMUQsR0FBSUYsR0FBZSxHQUFLc0QsTUFBTXRELEdBR25DLFlBRkFDLGNBQWNDLFlBQVkscUJBQXNCLFNBTWxELE1BQU1ILEVBQVUsQ0FBRWlDLFVBQUFBLEVBQVdoQyxZQUFBQSxFQUFhaUMsaUJBQUFBLEVBQWtCeEIsR0FBSXNELEtBQUtDLE9BR3JFOUUsT0FBTytFLFlBQVlsRSxHQUduQixNQUFNRCxTQUFFQSxFQUFRRixnQkFBRUEsRUFBZUMsWUFBRUEsR0FBZ0JYLE9BR25EZSxjQUFjaUUsZ0JBQWdCcEUsR0FHOUJHLGNBQWNrRSxzQkFBc0J2RSxFQUFpQkMsR0FHckRJLGNBQWNtRSxZQUFZbEYsUUFHUEYsU0FBU0MsY0FBYyxlQUMvQm9GLFFBR2IsU0FBUzVCLGNBQWNoQyxHQUVyQnZCLE9BQU91RCxjQUFjaEMsR0FHckIsTUFBTVgsU0FBRUEsRUFBUUYsZ0JBQUVBLEVBQWVDLFlBQUVBLEdBQWdCWCxPQUduRGUsY0FBY2lFLGdCQUFnQnBFLEdBRzlCRyxjQUFja0Usc0JBQXNCdkUsRUFBaUJDLEdBR3JESSxjQUFjbUUsWUFBWWxGIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBWYXJpYWJsZXMgeSBzZWxlY3RvcmVzICovXG5jb25zdCBleHBlbnNlc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjZXhwZW5zZXNMaXN0YCk7XG5sZXQgYnVkZ2V0O1xuXG4vKiBFdmVudG9zICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGBET01Db250ZW50TG9hZGVkYCwgc3RhcnRBcHApO1xuXG5mdW5jdGlvbiBzdGFydEFwcCgpIHtcbiAgcmVxdWVzdE5hbWUoKTtcbiAgcmVxdWVzdEJ1ZGdldCgpO1xuICBidWRnZXRGb3JtRXZlbnRzKCk7XG59XG5cbi8qIENsYXNlcyAqL1xuY2xhc3MgQnVkZ2V0IHtcbiAgY29uc3RydWN0b3IoYnVkZ2V0VG90YWwpIHtcbiAgICB0aGlzLmJ1ZGdldFRvdGFsID0gYnVkZ2V0VG90YWw7XG4gICAgdGhpcy5idWRnZXRBdmFpbGFibGUgPSBidWRnZXRUb3RhbDtcbiAgICB0aGlzLmJ1ZGdldFNwZW50ID0gMDtcbiAgICB0aGlzLmV4cGVuc2VzID0gW107XG4gIH1cblxuICBuZXdFeHBlbnNlcyhleHBlbnNlKSB7XG4gICAgLy8gVmFsaWRhciBxdWUgZWwgbW9udG8gaW50cm9kdWNpZG8gbm8gc2VhIG1heW9yIGFsIHByZXN1cHVlc3RvIGRpc3BvbmlibGVcbiAgICBpZiAoZXhwZW5zZS5pbnB1dEFtb3VudCA+IHRoaXMuYnVkZ2V0QXZhaWxhYmxlKSB7XG4gICAgICB1c2VySW50ZXJmYWNlLnByaW50QWxlcnRzKGBObyB0aWVuZXMgZm9uZG9zIHN1ZmljaWVudGVzYCwgYGVycm9yYCk7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBBw7FhZGlyIGVsIGdhc3RvIGEgbGEgbGlzdGEgZGUgZ2FzdG9zXG4gICAgdGhpcy5leHBlbnNlcyA9IFsuLi50aGlzLmV4cGVuc2VzLCBleHBlbnNlXTtcbiAgICB0aGlzLmNhbGN1bGF0ZVNwZW50KCk7XG5cbiAgICAvLyBJbXByaW1pciB1bmEgYWxlcnRhIGRlIGV4aXRvXG4gICAgdXNlckludGVyZmFjZS5wcmludEFsZXJ0cyhgU2UgYWdyZWfDsyBjb3JyZWN0YW1lbnRlYCwgYHN1Y2Nlc3NgKTtcbiAgfVxuXG4gIGNhbGN1bGF0ZVNwZW50KCkge1xuICAgIHRoaXMuYnVkZ2V0U3BlbnQgPSB0aGlzLmV4cGVuc2VzLnJlZHVjZShcbiAgICAgICh0b3RhbCwgZXhwZW5zZSkgPT4gdG90YWwgKyBleHBlbnNlLmlucHV0QW1vdW50LFxuICAgICAgMFxuICAgICk7XG4gICAgdGhpcy5idWRnZXRBdmFpbGFibGUgPSB0aGlzLmJ1ZGdldFRvdGFsIC0gdGhpcy5idWRnZXRTcGVudDtcbiAgfVxuXG4gIGRlbGV0ZUV4cGVuc2UoZXhwZW5zZUlkKSB7XG4gICAgLy8gRmlsdHJhciBsb3MgZ2FzdG9zIHF1ZSBubyB0aWVuZW4gZWwgaWQgZGUgZXhwZW5zZXNJZFxuICAgIGNvbnN0IGZpbHRlcmVkRXhwZW5zZXMgPSB0aGlzLmV4cGVuc2VzLmZpbHRlcihcbiAgICAgIChleHBlbnNlKSA9PiBleHBlbnNlLmlkICE9PSBleHBlbnNlSWRcbiAgICApO1xuXG4gICAgLy8gQWN0dWFsaXphciBlbCBhcnJheSBkZSBnYXN0b3NcbiAgICB0aGlzLmV4cGVuc2VzID0gZmlsdGVyZWRFeHBlbnNlcztcblxuICAgIC8vIFJlY2FsY3VsYXIgZWwgcHJlc3VwdWVzdG8gZGlzcG9uaWJsZSB5IGdhc3RhZG9cbiAgICB0aGlzLmNhbGN1bGF0ZVNwZW50KCk7XG4gIH1cbn1cblxuY2xhc3MgVXNlckludGVyZmFjZSB7XG4gIGluc2VydE5hbWUodXNlck5hbWUpIHtcbiAgICBjb25zdCBidWRnZXRVc2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLmJ1ZGdldF9faGVhZGluZy0tdXNlci1uYW1lYFxuICAgICk7XG5cbiAgICAvLyBJbnNlcnRhciBlbCBub21icmUgZGVsIHVzdWFyaW8gZW4gZWwgSFRNTFxuICAgIGJ1ZGdldFVzZXJOYW1lLnRleHRDb250ZW50ID0gYCR7dXNlck5hbWV9IWA7XG4gIH1cblxuICBpbnNlcnRCdWRnZXQocXVhbnRpdHkpIHtcbiAgICBjb25zdCB7IGJ1ZGdldFRvdGFsLCBidWRnZXRBdmFpbGFibGUsIGJ1ZGdldFNwZW50IH0gPSBxdWFudGl0eTtcblxuICAgIC8vIEZvcm1hdGVhciBlbCB0b3RhbCB5IGRpc3BvbmlibGUgZW4gbW9uZWRhIGxvY2FsIE1YTlxuICAgIGxldCBmb3JtYXR0ZWRUb3RhbCA9IGJ1ZGdldFRvdGFsLnRvTG9jYWxlU3RyaW5nKFwiZXMtTVhcIiwge1xuICAgICAgc3R5bGU6IFwiY3VycmVuY3lcIixcbiAgICAgIGN1cnJlbmN5OiBcIk1YTlwiLFxuICAgIH0pO1xuICAgIGxldCBmb3JtYXR0ZWRBdmFpbGFibGUgPSBidWRnZXRBdmFpbGFibGUudG9Mb2NhbGVTdHJpbmcoXCJlcy1NWFwiLCB7XG4gICAgICBzdHlsZTogXCJjdXJyZW5jeVwiLFxuICAgICAgY3VycmVuY3k6IFwiTVhOXCIsXG4gICAgfSk7XG4gICAgbGV0IGZvcm1hdHRlZFNwZW50ID0gYnVkZ2V0U3BlbnQudG9Mb2NhbGVTdHJpbmcoXCJlcy1NWFwiLCB7XG4gICAgICBzdHlsZTogXCJjdXJyZW5jeVwiLFxuICAgICAgY3VycmVuY3k6IFwiTVhOXCIsXG4gICAgfSk7XG5cbiAgICAvLyBJbnNlcnRhciBlbCB0b3RhbCB5IGRpc3BvbmlibGUgZW4gZWwgSFRNTFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgI2J1ZGdldENhcmRUb3RhbGBcbiAgICApLnRleHRDb250ZW50ID0gYCR7Zm9ybWF0dGVkVG90YWx9YDtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNidWRnZXRDYXJkQXZhaWxhYmxlYFxuICAgICkudGV4dENvbnRlbnQgPSBgJHtmb3JtYXR0ZWRBdmFpbGFibGV9YDtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNidWRnZXRDYXJkU3BlbnRgXG4gICAgKS50ZXh0Q29udGVudCA9IGAke2Zvcm1hdHRlZFNwZW50fWA7XG4gIH1cblxuICBwcmludEFsZXJ0cyhtZXNzYWdlLCB0eXBlQWxlcnQpIHtcbiAgICAvLyBMaW1waWFyIGxhcyBhbGVydGFzIGFudGVyaW9yZXMgcGFyYSBldml0YXIgZHVwbGljYWRvcy5cbiAgICBsZXQgZXhpc3RpbmdBbGVydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5hbGVydC0tJHt0eXBlQWxlcnR9YCk7XG5cbiAgICAvLyBTaSBoYXkgdW5hIGFsZXJ0YSBkZWwgbWlzbW8gdGlwbywgYWN0dWFsaXphciBlbCBtZW5zYWplIHkgbm8gYWdyZWdhciB1bm8gbnVldm9cbiAgICBpZiAoZXhpc3RpbmdBbGVydCkge1xuICAgICAgZXhpc3RpbmdBbGVydC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBDcmVhciBlbCBkaXYgZGUgbGEgYWxlcnRhXG4gICAgY29uc3QgYWxlcnRNZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgcGApO1xuICAgIGFsZXJ0TWVzc2FnZS5jbGFzc0xpc3QuYWRkKGBhbGVydGApO1xuXG4gICAgLy8gQWdyZWdhciBlbCBtZW5zYWplIHkgZWwgdGlwbyBkZSBhbGVydGEgYWwgcCBkZSBsYSBhbGVydGFcbiAgICBpZiAodHlwZUFsZXJ0ID09PSBgZXJyb3JgKSB7XG4gICAgICBhbGVydE1lc3NhZ2UuY2xhc3NMaXN0LmFkZChgYWxlcnQtLWVycm9yYCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0TWVzc2FnZS5jbGFzc0xpc3QuYWRkKGBhbGVydC0tc3VjY2Vzc2ApO1xuICAgIH1cblxuICAgIC8vIEFncmVnYXIgYWwgZGl2IGVsIG1lbnNhamVcbiAgICBhbGVydE1lc3NhZ2UudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuXG4gICAgLy8gSW5zZXJ0YXIgbGEgYWxlcnRhIGFsIEhUTUxcbiAgICBjb25zdCBidWRnZXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2J1ZGdldEZvcm1gKTtcbiAgICBidWRnZXRGb3JtLmFwcGVuZENoaWxkKGFsZXJ0TWVzc2FnZSk7XG5cbiAgICAvLyBFbGltaW5hciBsYSBhbGVydGEgZGVzcHXDqXMgZGUgMyBzZWd1bmRvc1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgYWxlcnRNZXNzYWdlLnJlbW92ZSgpO1xuICAgIH0sIDIwMDApO1xuICB9XG5cbiAgc2hvd0V4cGVuc2VMaXN0KGV4cGVuc2VzKSB7XG4gICAgLy8gTGltcGlhciBsYSBsaXN0YSBkZSBnYXN0b3NcbiAgICB0aGlzLmNsZWFuSHRtbCgpO1xuXG4gICAgLy8gSXRlcmFyIGxvcyBnYXN0b3NcbiAgICBleHBlbnNlcy5mb3JFYWNoKChleHBlbnNlKSA9PiB7XG4gICAgICBjb25zdCB7IGlucHV0TmFtZSwgaW5wdXRBbW91bnQsIHNlbGVjdGVkQ2F0ZWdvcnksIGlkIH0gPSBleHBlbnNlO1xuXG4gICAgICAvLyBGb3JtYXRlYXIgbGEgY2FudGlkYWRcbiAgICAgIGNvbnN0IGZvcm1hdHRlZEFtb3VudCA9IGlucHV0QW1vdW50LnRvTG9jYWxlU3RyaW5nKFwiZXMtTVhcIiwge1xuICAgICAgICBzdHlsZTogXCJjdXJyZW5jeVwiLFxuICAgICAgICBjdXJyZW5jeTogXCJNWE5cIixcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDcmVhciBlbCBMaVxuICAgICAgY29uc3QgZXhwZW5zZUl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGBsaWApO1xuICAgICAgZXhwZW5zZUl0ZW0uY2xhc3NOYW1lID0gYGV4cGVuc2UtaXRlbWA7XG4gICAgICBleHBlbnNlSXRlbS5kYXRhc2V0LmlkID0gaWQ7XG4gICAgICBleHBlbnNlSXRlbS5kYXRhc2V0LmNhdGVnb3J5ID0gc2VsZWN0ZWRDYXRlZ29yeTtcblxuICAgICAgLy8gQWdyZWdhciBlbCBIVE1MXG4gICAgICBleHBlbnNlSXRlbS5pbm5lckhUTUwgPSBgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJleHBlbnNlLWl0ZW1fX3RleHRzXCI+XG4gICAgICAgICAgPHAgY2xhc3M9XCJleHBlbnNlLWl0ZW1fX2Rlc2NyaXB0aW9uXCI+JHtpbnB1dE5hbWV9PC9wPlxuICAgICAgICAgIDxwIGNsYXNzPVwiZXhwZW5zZS1pdGVtX19wcmljZVwiPiR7Zm9ybWF0dGVkQW1vdW50fTwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgO1xuXG4gICAgICAvLyBCb3TDs24gcGFyYSBib3JyYXIgZWwgZ2FzdG9cbiAgICAgIGNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYGJ1dHRvbmApO1xuICAgICAgZGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoYGV4cGVuc2UtaXRlbV9fYnRuYCk7XG4gICAgICBkZWxldGVCdG4udGV4dENvbnRlbnQgPSBgWGA7XG4gICAgICBkZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCAoKSA9PiB7XG4gICAgICAgIGRlbGV0ZUV4cGVuc2UoaWQpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEHDsWFkaXIgZWwgYm90w7NuIGFsIExpXG4gICAgICBleHBlbnNlSXRlbS5hcHBlbmRDaGlsZChkZWxldGVCdG4pO1xuXG4gICAgICAvLyBBw7FhZGlyIGVsIExpIGFsIFVsXG4gICAgICBleHBlbnNlc0xpc3QuYXBwZW5kQ2hpbGQoZXhwZW5zZUl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgY2xlYW5IdG1sKCkge1xuICAgIHdoaWxlIChleHBlbnNlc0xpc3QuZmlyc3RDaGlsZCkge1xuICAgICAgZXhwZW5zZXNMaXN0LnJlbW92ZUNoaWxkKGV4cGVuc2VzTGlzdC5maXJzdENoaWxkKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVBdmFpbGFibGVCdWRnZXQoYXZhaWxhYmxlLCBzcGVudCkge1xuICAgIGxldCBmb3JtYXR0ZWRBdmFpbGFibGUgPSBhdmFpbGFibGUudG9Mb2NhbGVTdHJpbmcoXCJlcy1NWFwiLCB7XG4gICAgICBzdHlsZTogXCJjdXJyZW5jeVwiLFxuICAgICAgY3VycmVuY3k6IFwiTVhOXCIsXG4gICAgfSk7XG4gICAgbGV0IGZvcm1hdHRlZFNwZW50ID0gc3BlbnQudG9Mb2NhbGVTdHJpbmcoXCJlcy1NWFwiLCB7XG4gICAgICBzdHlsZTogXCJjdXJyZW5jeVwiLFxuICAgICAgY3VycmVuY3k6IFwiTVhOXCIsXG4gICAgfSk7XG5cbiAgICAvLyBBY3R1YWxpemFyIGVsIGRpc3BvbmlibGUgeSBlbCBnYXN0YWRvIGVuIGVsIEhUTUxcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNidWRnZXRDYXJkQXZhaWxhYmxlYFxuICAgICkudGV4dENvbnRlbnQgPSBgJHtmb3JtYXR0ZWRBdmFpbGFibGV9YDtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNidWRnZXRDYXJkU3BlbnRgXG4gICAgKS50ZXh0Q29udGVudCA9IGAke2Zvcm1hdHRlZFNwZW50fWA7XG4gIH1cblxuICBjaGVja0J1ZGdldChidWRnZXRPYmopIHtcbiAgICBjb25zdCB7IGJ1ZGdldFRvdGFsLCBidWRnZXRBdmFpbGFibGUgfSA9IGJ1ZGdldE9iajtcblxuICAgIC8qICAgaWYgKGJ1ZGdldFRvdGFsIC8gNCA+IGJ1ZGdldEF2YWlsYWJsZSkge1xuICAgICAgY29uc29sZS5sb2coYEdhc3Rhc3RlIGVsIDc1JWApO1xuICAgIH0gZWxzZSBpZiAoYnVkZ2V0VG90YWwgLyAyID4gYnVkZ2V0QXZhaWxhYmxlKSB7XG4gICAgICBjb25zb2xlLmxvZyhgR2FzdGFzdGUgZWwgNTAlYCk7XG4gICAgfSAqL1xuXG4gICAgY29uc3QgYnVkZ2V0Rm9ybUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5idWRnZXQtZm9ybV9fYnRuYCk7XG5cbiAgICAvLyBEZXNhY3RpdmFyIGVsIGJvdMOzbiBkZSBhZ3JlZ2FyIGdhc3RvIHNpIGVsIHByZXN1cHVlc3RvIGVzdMOhIGFnb3RhZG9cbiAgICBpZiAoYnVkZ2V0QXZhaWxhYmxlIDw9IDApIHtcbiAgICAgIHVzZXJJbnRlcmZhY2UucHJpbnRBbGVydHMoYEVsIHByZXN1cHVlc3RvIHNlIGhhIGFnb3RhZG9gLCBgZXJyb3JgKTtcbiAgICAgIGJ1ZGdldEZvcm1CdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBidWRnZXRGb3JtQnRuLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG59XG5cbi8vIEluc3RhbmNpYXIgbGEgVUlcbmNvbnN0IHVzZXJJbnRlcmZhY2UgPSBuZXcgVXNlckludGVyZmFjZSgpO1xuXG4vKiBGdW5jaW9uZXMgKi9cblxuZnVuY3Rpb24gcmVxdWVzdE5hbWUoKSB7XG4gIGxldCB1c2VyTmFtZTtcblxuICAvLyBTb2xpY2l0YXIgZWwgbm9tYnJlIGRlbCB1c3VhcmlvIGhhc3RhIHF1ZSBzZSBpbmdyZXNlIHVuIHZhbG9yIHbDoWxpZG9cbiAgZG8ge1xuICAgIHVzZXJOYW1lID0gcHJvbXB0KGDCv0N1w6FsIGVzIHR1IG5vbWJyZT9gKTtcblxuICAgIC8vIFZhbGlkYXIgZWwgbm9tYnJlXG4gICAgaWYgKCF1c2VyTmFtZSkge1xuICAgICAgYWxlcnQoYFBvciBmYXZvciwgaW50cm9kdWNlIHVuIG5vbWJyZSB2w6FsaWRvLmApO1xuICAgIH1cbiAgfSB3aGlsZSAoIXVzZXJOYW1lKTtcblxuICAvLyBMbGFtYXIgYWwgbcOpdG9kbyBwYXJhIGluc2VydGFyIGVsIG5vbWJyZSBlbiBsYSBVSVxuICB1c2VySW50ZXJmYWNlLmluc2VydE5hbWUodXNlck5hbWUpO1xufVxuXG5mdW5jdGlvbiByZXF1ZXN0QnVkZ2V0KCkge1xuICBjb25zdCB1c2VyQnVkZ2V0ID0gTnVtYmVyKHByb21wdChgwr9DdcOhbCBlcyB0dSBwcmVzdXB1ZXN0bz9gKSk7XG4gIGNvbnN0IHZvaWRWYWx1ZSA9IGBgO1xuXG4gIGlmIChcbiAgICB1c2VyQnVkZ2V0ID09PSB2b2lkVmFsdWUgfHxcbiAgICB1c2VyQnVkZ2V0ID09PSBudWxsIHx8XG4gICAgaXNOYU4odXNlckJ1ZGdldCkgfHxcbiAgICB1c2VyQnVkZ2V0IDw9IDBcbiAgKSB7XG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICB9XG5cbiAgLy8gQ3JlYXIgaW5zdGFuY2lhIGRlIFwiQnVkZ2V0XCIgeSBlc3RhYmxlY2VybG9cbiAgYnVkZ2V0ID0gbmV3IEJ1ZGdldCh1c2VyQnVkZ2V0KTtcblxuICAvLyBMbGFtYXIgYWwgbcOpdG9kbyBwYXJhIGluc2VydGFyIGVsIHByZXN1cHVlc3RvIGVuIGxhIFVJXG4gIHVzZXJJbnRlcmZhY2UuaW5zZXJ0QnVkZ2V0KGJ1ZGdldCk7XG59XG5cbmZ1bmN0aW9uIGJ1ZGdldEZvcm1FdmVudHMoKSB7XG4gIC8vIE9idGVuZXIgZWwgZm9ybXVsYXJpbyB5IHN1cyBldmVudG9zXG4gIGNvbnN0IGJ1ZGdldEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjYnVkZ2V0Rm9ybWApO1xuICBidWRnZXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoYHN1Ym1pdGAsIGFkZEV4cGVuc2UpO1xufVxuXG5mdW5jdGlvbiBhZGRFeHBlbnNlKGUpIHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIC8vIE9idGVuZXIgbG9zIHZhbG9yZXMgZGVsIGZvcm11bGFyaW9cbiAgY29uc3QgaW5wdXROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2J1ZGdldEZvcm1OYW1lYCkudmFsdWU7XG4gIGNvbnN0IGlucHV0QW1vdW50ID0gTnVtYmVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNidWRnZXRGb3JtQW1vdW50YCkudmFsdWUpO1xuICBjb25zdCBzZWxlY3RlZENhdGVnb3J5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2J1ZGdldEZvcm1DYXRlZ29yeWApLnZhbHVlO1xuICBsZXQgdm9pZFZhbHVlID0gYGA7XG5cbiAgLy8gVmFsaWRhciBxdWUgbmluZ3VubyBkZSBsb3MgY2FtcG9zIGVzdMOpIHZhY8Otb1xuICBpZiAoXG4gICAgaW5wdXROYW1lID09PSB2b2lkVmFsdWUgfHxcbiAgICBpbnB1dEFtb3VudCA9PT0gdm9pZFZhbHVlIHx8XG4gICAgc2VsZWN0ZWRDYXRlZ29yeSA9PT0gdm9pZFZhbHVlXG4gICkge1xuICAgIHVzZXJJbnRlcmZhY2UucHJpbnRBbGVydHMoYFRvZG9zIGxvcyBjYW1wb3Mgc29uIG9ibGlnYXRvcmlvc2AsIGBlcnJvcmApO1xuXG4gICAgcmV0dXJuO1xuICB9IGVsc2UgaWYgKGlucHV0QW1vdW50IDw9IDAgfHwgaXNOYU4oaW5wdXRBbW91bnQpKSB7XG4gICAgdXNlckludGVyZmFjZS5wcmludEFsZXJ0cyhgQ2FudGlkYWQgbm8gdmFsaWRhYCwgYGVycm9yYCk7XG5cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBDcmVhciBvYmpldG8gY29uIGVsIGdhc3RvXG4gIGNvbnN0IGV4cGVuc2UgPSB7IGlucHV0TmFtZSwgaW5wdXRBbW91bnQsIHNlbGVjdGVkQ2F0ZWdvcnksIGlkOiBEYXRlLm5vdygpIH07XG5cbiAgLy8gQcOxYWRpciBlbCBnYXN0byBhIGxhIGxpc3RhIHkgYWwgcHJlc3VwdWVzdG9cbiAgYnVkZ2V0Lm5ld0V4cGVuc2VzKGV4cGVuc2UpO1xuXG4gIC8vIE9idGVuZXIgbG9zIHZhbG9yZXMgYWN0dWFsZXMgZGVsIHByZXN1cHVlc3RvIHkgZ2FzdG9cbiAgY29uc3QgeyBleHBlbnNlcywgYnVkZ2V0QXZhaWxhYmxlLCBidWRnZXRTcGVudCB9ID0gYnVkZ2V0O1xuXG4gIC8vIEltcHJpbWlyIGVsIGdhc3RvIGVuIGVsIEhUTUxcbiAgdXNlckludGVyZmFjZS5zaG93RXhwZW5zZUxpc3QoZXhwZW5zZXMpO1xuXG4gIC8vIEFjdHVhbGl6YXIgZWwgcHJlc3VwdWVzdG8gZW4gbGEgVUlcbiAgdXNlckludGVyZmFjZS51cGRhdGVBdmFpbGFibGVCdWRnZXQoYnVkZ2V0QXZhaWxhYmxlLCBidWRnZXRTcGVudCk7XG5cbiAgLy8gTGxhbWFyIGFsIG3DqXRvZG8gcGFyYSBjb21wcm9iYXIgc2kgc2UgaGEgYWxjYW56YWRvIGVsIHByZXN1cHVlc3RvXG4gIHVzZXJJbnRlcmZhY2UuY2hlY2tCdWRnZXQoYnVkZ2V0KTtcblxuICAvLyBMaW1waWFyIGxvcyBjYW1wb3MgZGVsIGZvcm11bGFyaW9cbiAgY29uc3QgYnVkZ2V0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNidWRnZXRGb3JtYCk7XG4gIGJ1ZGdldEZvcm0ucmVzZXQoKTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlRXhwZW5zZShpZCkge1xuICAvLyBFbGltaW5hciBlbCBnYXN0byBkZWwgb2JqZXRvXG4gIGJ1ZGdldC5kZWxldGVFeHBlbnNlKGlkKTtcblxuICAvLyBPYnRlbmVyIGxvcyB2YWxvcmVzIGFjdHVhbGVzIGRlbCBwcmVzdXB1ZXN0byB5IGdhc3RvXG4gIGNvbnN0IHsgZXhwZW5zZXMsIGJ1ZGdldEF2YWlsYWJsZSwgYnVkZ2V0U3BlbnQgfSA9IGJ1ZGdldDtcblxuICAvLyBFbGltaW5hciBlbCBnYXN0byBkZWwgSFRNTFxuICB1c2VySW50ZXJmYWNlLnNob3dFeHBlbnNlTGlzdChleHBlbnNlcyk7XG5cbiAgLy8gQWN0dWFsaXphciBlbCBwcmVzdXB1ZXN0byBlbiBsYSBVSVxuICB1c2VySW50ZXJmYWNlLnVwZGF0ZUF2YWlsYWJsZUJ1ZGdldChidWRnZXRBdmFpbGFibGUsIGJ1ZGdldFNwZW50KTtcblxuICAvLyBMbGFtYXIgYWwgbcOpdG9kbyBwYXJhIGNvbXByb2JhciBzaSBzZSBoYSBhbGNhbnphZG8gZWwgcHJlc3VwdWVzdG9cbiAgdXNlckludGVyZmFjZS5jaGVja0J1ZGdldChidWRnZXQpO1xufVxuIl19
