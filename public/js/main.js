const expensesList=document.querySelector("#expensesList");function startApp(){loadLocalStorage(),budgetFormEvents()}document.addEventListener("DOMContentLoaded",startApp);class Budget{constructor(e){this.budgetTotal=e,this.budgetAvailable=e,this.budgetSpent=0,this.expenses=[]}newExpenses(e){e.inputAmount>this.budgetAvailable?userInterface.printAlerts("No tienes fondos suficientes","error"):(this.expenses=[...this.expenses,e],this.calculateSpent(),userInterface.printAlerts("Se agregó correctamente","success"))}calculateSpent(){this.budgetSpent=this.expenses.reduce((e,t)=>e+t.inputAmount,0),this.budgetAvailable=this.budgetTotal-this.budgetSpent}deleteExpense(e){const t=this.expenses.filter(t=>t.id!==e);this.expenses=t,this.calculateSpent()}}class UserInterface{insertName(e){document.querySelector(".budget__heading--user-name").textContent=e+"!"}insertBudget(e){const{budgetTotal:t,budgetAvailable:n,budgetSpent:r}=e;let s=t.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),u=n.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),o=r.toLocaleString("es-MX",{style:"currency",currency:"MXN"});document.querySelector("#budgetCardTotal").textContent=""+s,document.querySelector("#budgetCardAvailable").textContent=""+u,document.querySelector("#budgetCardSpent").textContent=""+o}printAlerts(e,t){let n=document.querySelector(".alert--"+t);if(n)return void(n.textContent=e);const r=document.createElement("p");r.classList.add("alert"),"error"===t?r.classList.add("alert--error"):r.classList.add("alert--success"),r.textContent=e;document.querySelector("#budgetForm").appendChild(r),setTimeout(()=>{r.remove()},2e3)}showExpenseList(e){this.cleanHtml(),e.forEach(e=>{const{inputName:t,inputAmount:n,selectedCategory:r,id:s}=e,u=n.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),o=document.createElement("li");o.className="expense-item",o.dataset.id=s,o.dataset.category=r,o.innerHTML=`\n        <div class="expense-item__texts">\n          <p class="expense-item__description">${t}</p>\n          <p class="expense-item__price">${u}</p>\n        </div>\n      `;const a=document.createElement("button");a.classList.add("expense-item__btn"),a.textContent="X",a.addEventListener("click",()=>{deleteExpense(s)}),o.appendChild(a),expensesList.appendChild(o)})}cleanHtml(){for(;expensesList.firstChild;)expensesList.removeChild(expensesList.firstChild)}updateAvailableBudget(e,t){let n=e.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),r=t.toLocaleString("es-MX",{style:"currency",currency:"MXN"});document.querySelector("#budgetCardAvailable").textContent=""+n,document.querySelector("#budgetCardSpent").textContent=""+r}checkBudget(e){const{budgetTotal:t,budgetAvailable:n}=e,r=document.querySelector(".budget-form__btn");n<=0?(userInterface.printAlerts("El presupuesto se ha agotado","error"),r.disabled=!0):r.disabled=!1}}let budget;const userInterface=new UserInterface;function loadLocalStorage(){let e=JSON.parse(localStorage.getItem("username"));budget=JSON.parse(localStorage.getItem("budget")),e?userInterface.insertName(e):requestName(e),budget?(budget=new Budget(budget.budgetTotal),userInterface.insertBudget(budget)):requestBudget()}function requestName(e){do{(e=prompt("¿Cuál es tu nombre?"))||alert("Por favor, introduce un nombre válido.")}while(!e);userInterface.insertName(e),saveToLocalStorage("username",e)}function requestBudget(){const e=Number(prompt("¿Cuál es tu presupuesto?"));(""===e||null===e||isNaN(e)||e<=0)&&window.location.reload(),budget=new Budget(e),userInterface.insertBudget(budget),saveToLocalStorage("budget",budget)}function budgetFormEvents(){document.querySelector("#budgetForm").addEventListener("submit",addExpense)}function addExpense(e){e.preventDefault();const t=document.querySelector("#budgetFormName").value,n=Number(document.querySelector("#budgetFormAmount").value),r=document.querySelector("#budgetFormCategory").value;if(""===t||""===n||""===r)return void userInterface.printAlerts("Todos los campos son obligatorios","error");if(n<=0||isNaN(n))return void userInterface.printAlerts("Cantidad no valida","error");const s={inputName:t,inputAmount:n,selectedCategory:r,id:Date.now()};budget.newExpenses(s);const{expenses:u,budgetAvailable:o,budgetSpent:a}=budget;userInterface.showExpenseList(u),userInterface.updateAvailableBudget(o,a),userInterface.checkBudget(budget);document.querySelector("#budgetForm").reset(),saveToLocalStorage("budget",budget)}function deleteExpense(e){budget.deleteExpense(e);const{expenses:t,budgetAvailable:n,budgetSpent:r}=budget;userInterface.showExpenseList(t),userInterface.updateAvailableBudget(n,r),userInterface.checkBudget(budget),saveToLocalStorage("budget",budget)}function saveToLocalStorage(e,t){localStorage.setItem(e,JSON.stringify(t))}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZXhwZW5zZXNMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3RhcnRBcHAiLCJsb2FkTG9jYWxTdG9yYWdlIiwiYnVkZ2V0Rm9ybUV2ZW50cyIsImFkZEV2ZW50TGlzdGVuZXIiLCJCdWRnZXQiLCJbb2JqZWN0IE9iamVjdF0iLCJidWRnZXRUb3RhbCIsInRoaXMiLCJidWRnZXRBdmFpbGFibGUiLCJidWRnZXRTcGVudCIsImV4cGVuc2VzIiwiZXhwZW5zZSIsImlucHV0QW1vdW50IiwidXNlckludGVyZmFjZSIsInByaW50QWxlcnRzIiwiY2FsY3VsYXRlU3BlbnQiLCJyZWR1Y2UiLCJ0b3RhbCIsImV4cGVuc2VJZCIsImZpbHRlcmVkRXhwZW5zZXMiLCJmaWx0ZXIiLCJpZCIsIlVzZXJJbnRlcmZhY2UiLCJ1c2VyTmFtZSIsInRleHRDb250ZW50IiwicXVhbnRpdHkiLCJmb3JtYXR0ZWRUb3RhbCIsInRvTG9jYWxlU3RyaW5nIiwic3R5bGUiLCJjdXJyZW5jeSIsImZvcm1hdHRlZEF2YWlsYWJsZSIsImZvcm1hdHRlZFNwZW50IiwibWVzc2FnZSIsInR5cGVBbGVydCIsImV4aXN0aW5nQWxlcnQiLCJhbGVydE1lc3NhZ2UiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJzZXRUaW1lb3V0IiwicmVtb3ZlIiwiY2xlYW5IdG1sIiwiZm9yRWFjaCIsImlucHV0TmFtZSIsInNlbGVjdGVkQ2F0ZWdvcnkiLCJmb3JtYXR0ZWRBbW91bnQiLCJleHBlbnNlSXRlbSIsImNsYXNzTmFtZSIsImRhdGFzZXQiLCJjYXRlZ29yeSIsImlubmVySFRNTCIsImRlbGV0ZUJ0biIsImRlbGV0ZUV4cGVuc2UiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJhdmFpbGFibGUiLCJzcGVudCIsImJ1ZGdldE9iaiIsImJ1ZGdldEZvcm1CdG4iLCJkaXNhYmxlZCIsImJ1ZGdldCIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJpbnNlcnROYW1lIiwicmVxdWVzdE5hbWUiLCJpbnNlcnRCdWRnZXQiLCJyZXF1ZXN0QnVkZ2V0IiwicHJvbXB0IiwiYWxlcnQiLCJzYXZlVG9Mb2NhbFN0b3JhZ2UiLCJ1c2VyQnVkZ2V0IiwiTnVtYmVyIiwiaXNOYU4iLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsImFkZEV4cGVuc2UiLCJlIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsIkRhdGUiLCJub3ciLCJuZXdFeHBlbnNlcyIsInNob3dFeHBlbnNlTGlzdCIsInVwZGF0ZUF2YWlsYWJsZUJ1ZGdldCIsImNoZWNrQnVkZ2V0IiwicmVzZXQiLCJrZXkiLCJzZXRJdGVtIiwic3RyaW5naWZ5Il0sIm1hcHBpbmdzIjoiQUFDQSxNQUFNQSxhQUFlQyxTQUFTQyxjQUFjLGlCQUs1QyxTQUFTQyxXQUNQQyxtQkFDQUMsbUJBSkZKLFNBQVNLLGlCQUFpQixtQkFBb0JILFVBUTlDLE1BQU1JLE9BQ0pDLFlBQVlDLEdBQ1ZDLEtBQUtELFlBQWNBLEVBQ25CQyxLQUFLQyxnQkFBa0JGLEVBQ3ZCQyxLQUFLRSxZQUFjLEVBQ25CRixLQUFLRyxTQUFXLEdBR2xCTCxZQUFZTSxHQUVOQSxFQUFRQyxZQUFjTCxLQUFLQyxnQkFDN0JLLGNBQWNDLFlBQVksK0JBQWdDLFVBTTVEUCxLQUFLRyxTQUFXLElBQUlILEtBQUtHLFNBQVVDLEdBQ25DSixLQUFLUSxpQkFHTEYsY0FBY0MsWUFBWSwwQkFBMkIsWUFHdkRULGlCQUNFRSxLQUFLRSxZQUFjRixLQUFLRyxTQUFTTSxPQUMvQixDQUFDQyxFQUFPTixJQUFZTSxFQUFRTixFQUFRQyxZQUNwQyxHQUVGTCxLQUFLQyxnQkFBa0JELEtBQUtELFlBQWNDLEtBQUtFLFlBR2pESixjQUFjYSxHQUVaLE1BQU1DLEVBQW1CWixLQUFLRyxTQUFTVSxPQUNwQ1QsR0FBWUEsRUFBUVUsS0FBT0gsR0FJOUJYLEtBQUtHLFNBQVdTLEVBR2hCWixLQUFL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QkFBbUIsU0FBVVgsUUFHL0IsU0FBU1IsY0FBY2hDLEdBRXJCd0MsT0FBT1IsY0FBY2hDLEdBR3JCLE1BQU1YLFNBQUVBLEVBQVFGLGdCQUFFQSxFQUFlQyxZQUFFQSxHQUFnQm9ELE9BR25EaEQsY0FBY3lFLGdCQUFnQjVFLEdBRzlCRyxjQUFjMEUsc0JBQXNCL0UsRUFBaUJDLEdBR3JESSxjQUFjMkUsWUFBWTNCLFFBRzFCVyxtQkFBbUIsU0FBVVgsUUFHL0IsU0FBU1csbUJBQW1Ca0IsRUFBS1IsR0FFL0JsQixhQUFhMkIsUUFBUUQsRUFBSzVCLEtBQUs4QixVQUFVViIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogVmFyaWFibGVzIHkgc2VsZWN0b3JlcyAqL1xuY29uc3QgZXhwZW5zZXNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2V4cGVuc2VzTGlzdGApO1xuXG4vKiBFdmVudG9zICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGBET01Db250ZW50TG9hZGVkYCwgc3RhcnRBcHApO1xuXG5mdW5jdGlvbiBzdGFydEFwcCgpIHtcbiAgbG9hZExvY2FsU3RvcmFnZSgpO1xuICBidWRnZXRGb3JtRXZlbnRzKCk7XG59XG5cbi8qIENsYXNlcyAqL1xuY2xhc3MgQnVkZ2V0IHtcbiAgY29uc3RydWN0b3IoYnVkZ2V0VG90YWwpIHtcbiAgICB0aGlzLmJ1ZGdldFRvdGFsID0gYnVkZ2V0VG90YWw7XG4gICAgdGhpcy5idWRnZXRBdmFpbGFibGUgPSBidWRnZXRUb3RhbDtcbiAgICB0aGlzLmJ1ZGdldFNwZW50ID0gMDtcbiAgICB0aGlzLmV4cGVuc2VzID0gW107XG4gIH1cblxuICBuZXdFeHBlbnNlcyhleHBlbnNlKSB7XG4gICAgLy8gVmFsaWRhciBxdWUgZWwgbW9udG8gaW50cm9kdWNpZG8gbm8gc2VhIG1heW9yIGFsIHByZXN1cHVlc3RvIGRpc3BvbmlibGVcbiAgICBpZiAoZXhwZW5zZS5pbnB1dEFtb3VudCA+IHRoaXMuYnVkZ2V0QXZhaWxhYmxlKSB7XG4gICAgICB1c2VySW50ZXJmYWNlLnByaW50QWxlcnRzKGBObyB0aWVuZXMgZm9uZG9zIHN1ZmljaWVudGVzYCwgYGVycm9yYCk7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBBw7FhZGlyIGVsIGdhc3RvIGEgbGEgbGlzdGEgZGUgZ2FzdG9zXG4gICAgdGhpcy5leHBlbnNlcyA9IFsuLi50aGlzLmV4cGVuc2VzLCBleHBlbnNlXTtcbiAgICB0aGlzLmNhbGN1bGF0ZVNwZW50KCk7XG5cbiAgICAvLyBJbXByaW1pciB1bmEgYWxlcnRhIGRlIGV4aXRvXG4gICAgdXNlckludGVyZmFjZS5wcmludEFsZXJ0cyhgU2UgYWdyZWfDsyBjb3JyZWN0YW1lbnRlYCwgYHN1Y2Nlc3NgKTtcbiAgfVxuXG4gIGNhbGN1bGF0ZVNwZW50KCkge1xuICAgIHRoaXMuYnVkZ2V0U3BlbnQgPSB0aGlzLmV4cGVuc2VzLnJlZHVjZShcbiAgICAgICh0b3RhbCwgZXhwZW5zZSkgPT4gdG90YWwgKyBleHBlbnNlLmlucHV0QW1vdW50LFxuICAgICAgMFxuICAgICk7XG4gICAgdGhpcy5idWRnZXRBdmFpbGFibGUgPSB0aGlzLmJ1ZGdldFRvdGFsIC0gdGhpcy5idWRnZXRTcGVudDtcbiAgfVxuXG4gIGRlbGV0ZUV4cGVuc2UoZXhwZW5zZUlkKSB7XG4gICAgLy8gRmlsdHJhciBsb3MgZ2FzdG9zIHF1ZSBubyB0aWVuZW4gZWwgaWQgZGUgZXhwZW5zZXNJZFxuICAgIGNvbnN0IGZpbHRlcmVkRXhwZW5zZXMgPSB0aGlzLmV4cGVuc2VzLmZpbHRlcihcbiAgICAgIChleHBlbnNlKSA9PiBleHBlbnNlLmlkICE9PSBleHBlbnNlSWRcbiAgICApO1xuXG4gICAgLy8gQWN0dWFsaXphciBlbCBhcnJheSBkZSBnYXN0b3NcbiAgICB0aGlzLmV4cGVuc2VzID0gZmlsdGVyZWRFeHBlbnNlcztcblxuICAgIC8vIFJlY2FsY3VsYXIgZWwgcHJlc3VwdWVzdG8gZGlzcG9uaWJsZSB5IGdhc3RhZG9cbiAgICB0aGlzLmNhbGN1bGF0ZVNwZW50KCk7XG4gIH1cbn1cblxuY2xhc3MgVXNlckludGVyZmFjZSB7XG4gIGluc2VydE5hbWUodXNlck5hbWUpIHtcbiAgICBjb25zdCBidWRnZXRVc2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLmJ1ZGdldF9faGVhZGluZy0tdXNlci1uYW1lYFxuICAgICk7XG5cbiAgICAvLyBJbnNlcnRhciBlbCBub21icmUgZGVsIHVzdWFyaW8gZW4gZWwgSFRNTFxuICAgIGJ1ZGdldFVzZXJOYW1lLnRleHRDb250ZW50ID0gYCR7dXNlck5hbWV9IWA7XG4gIH1cblxuICBpbnNlcnRCdWRnZXQocXVhbnRpdHkpIHtcbiAgICBjb25zdCB7IGJ1ZGdldFRvdGFsLCBidWRnZXRBdmFpbGFibGUsIGJ1ZGdldFNwZW50IH0gPSBxdWFudGl0eTtcblxuICAgIC8vIEZvcm1hdGVhciBlbCB0b3RhbCB5IGRpc3BvbmlibGUgZW4gbW9uZWRhIGxvY2FsIE1YTlxuICAgIGxldCBmb3JtYXR0ZWRUb3RhbCA9IGJ1ZGdldFRvdGFsLnRvTG9jYWxlU3RyaW5nKFwiZXMtTVhcIiwge1xuICAgICAgc3R5bGU6IFwiY3VycmVuY3lcIixcbiAgICAgIGN1cnJlbmN5OiBcIk1YTlwiLFxuICAgIH0pO1xuICAgIGxldCBmb3JtYXR0ZWRBdmFpbGFibGUgPSBidWRnZXRBdmFpbGFibGUudG9Mb2NhbGVTdHJpbmcoXCJlcy1NWFwiLCB7XG4gICAgICBzdHlsZTogXCJjdXJyZW5jeVwiLFxuICAgICAgY3VycmVuY3k6IFwiTVhOXCIsXG4gICAgfSk7XG4gICAgbGV0IGZvcm1hdHRlZFNwZW50ID0gYnVkZ2V0U3BlbnQudG9Mb2NhbGVTdHJpbmcoXCJlcy1NWFwiLCB7XG4gICAgICBzdHlsZTogXCJjdXJyZW5jeVwiLFxuICAgICAgY3VycmVuY3k6IFwiTVhOXCIsXG4gICAgfSk7XG5cbiAgICAvLyBJbnNlcnRhciBlbCB0b3RhbCB5IGRpc3BvbmlibGUgZW4gZWwgSFRNTFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgI2J1ZGdldENhcmRUb3RhbGBcbiAgICApLnRleHRDb250ZW50ID0gYCR7Zm9ybWF0dGVkVG90YWx9YDtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNidWRnZXRDYXJkQXZhaWxhYmxlYFxuICAgICkudGV4dENvbnRlbnQgPSBgJHtmb3JtYXR0ZWRBdmFpbGFibGV9YDtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNidWRnZXRDYXJkU3BlbnRgXG4gICAgKS50ZXh0Q29udGVudCA9IGAke2Zvcm1hdHRlZFNwZW50fWA7XG4gIH1cblxuICBwcmludEFsZXJ0cyhtZXNzYWdlLCB0eXBlQWxlcnQpIHtcbiAgICAvLyBMaW1waWFyIGxhcyBhbGVydGFzIGFudGVyaW9yZXMgcGFyYSBldml0YXIgZHVwbGljYWRvcy5cbiAgICBsZXQgZXhpc3RpbmdBbGVydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5hbGVydC0tJHt0eXBlQWxlcnR9YCk7XG5cbiAgICAvLyBTaSBoYXkgdW5hIGFsZXJ0YSBkZWwgbWlzbW8gdGlwbywgYWN0dWFsaXphciBlbCBtZW5zYWplIHkgbm8gYWdyZWdhciB1bm8gbnVldm9cbiAgICBpZiAoZXhpc3RpbmdBbGVydCkge1xuICAgICAgZXhpc3RpbmdBbGVydC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBDcmVhciBlbCBkaXYgZGUgbGEgYWxlcnRhXG4gICAgY29uc3QgYWxlcnRNZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgcGApO1xuICAgIGFsZXJ0TWVzc2FnZS5jbGFzc0xpc3QuYWRkKGBhbGVydGApO1xuXG4gICAgLy8gQWdyZWdhciBlbCBtZW5zYWplIHkgZWwgdGlwbyBkZSBhbGVydGEgYWwgcCBkZSBsYSBhbGVydGFcbiAgICBpZiAodHlwZUFsZXJ0ID09PSBgZXJyb3JgKSB7XG4gICAgICBhbGVydE1lc3NhZ2UuY2xhc3NMaXN0LmFkZChgYWxlcnQtLWVycm9yYCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0TWVzc2FnZS5jbGFzc0xpc3QuYWRkKGBhbGVydC0tc3VjY2Vzc2ApO1xuICAgIH1cblxuICAgIC8vIEFncmVnYXIgYWwgZGl2IGVsIG1lbnNhamVcbiAgICBhbGVydE1lc3NhZ2UudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuXG4gICAgLy8gSW5zZXJ0YXIgbGEgYWxlcnRhIGFsIEhUTUxcbiAgICBjb25zdCBidWRnZXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2J1ZGdldEZvcm1gKTtcbiAgICBidWRnZXRGb3JtLmFwcGVuZENoaWxkKGFsZXJ0TWVzc2FnZSk7XG5cbiAgICAvLyBFbGltaW5hciBsYSBhbGVydGEgZGVzcHXDqXMgZGUgMyBzZWd1bmRvc1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgYWxlcnRNZXNzYWdlLnJlbW92ZSgpO1xuICAgIH0sIDIwMDApO1xuICB9XG5cbiAgc2hvd0V4cGVuc2VMaXN0KGV4cGVuc2VzKSB7XG4gICAgLy8gTGltcGlhciBsYSBsaXN0YSBkZSBnYXN0b3NcbiAgICB0aGlzLmNsZWFuSHRtbCgpO1xuXG4gICAgLy8gSXRlcmFyIGxvcyBnYXN0b3NcbiAgICBleHBlbnNlcy5mb3JFYWNoKChleHBlbnNlKSA9PiB7XG4gICAgICBjb25zdCB7IGlucHV0TmFtZSwgaW5wdXRBbW91bnQsIHNlbGVjdGVkQ2F0ZWdvcnksIGlkIH0gPSBleHBlbnNlO1xuXG4gICAgICAvLyBGb3JtYXRlYXIgbGEgY2FudGlkYWRcbiAgICAgIGNvbnN0IGZvcm1hdHRlZEFtb3VudCA9IGlucHV0QW1vdW50LnRvTG9jYWxlU3RyaW5nKFwiZXMtTVhcIiwge1xuICAgICAgICBzdHlsZTogXCJjdXJyZW5jeVwiLFxuICAgICAgICBjdXJyZW5jeTogXCJNWE5cIixcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDcmVhciBlbCBMaVxuICAgICAgY29uc3QgZXhwZW5zZUl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGBsaWApO1xuICAgICAgZXhwZW5zZUl0ZW0uY2xhc3NOYW1lID0gYGV4cGVuc2UtaXRlbWA7XG4gICAgICBleHBlbnNlSXRlbS5kYXRhc2V0LmlkID0gaWQ7XG4gICAgICBleHBlbnNlSXRlbS5kYXRhc2V0LmNhdGVnb3J5ID0gc2VsZWN0ZWRDYXRlZ29yeTtcblxuICAgICAgLy8gQWdyZWdhciBlbCBIVE1MXG4gICAgICBleHBlbnNlSXRlbS5pbm5lckhUTUwgPSBgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJleHBlbnNlLWl0ZW1fX3RleHRzXCI+XG4gICAgICAgICAgPHAgY2xhc3M9XCJleHBlbnNlLWl0ZW1fX2Rlc2NyaXB0aW9uXCI+JHtpbnB1dE5hbWV9PC9wPlxuICAgICAgICAgIDxwIGNsYXNzPVwiZXhwZW5zZS1pdGVtX19wcmljZVwiPiR7Zm9ybWF0dGVkQW1vdW50fTwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgO1xuXG4gICAgICAvLyBCb3TDs24gcGFyYSBib3JyYXIgZWwgZ2FzdG9cbiAgICAgIGNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYGJ1dHRvbmApO1xuICAgICAgZGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoYGV4cGVuc2UtaXRlbV9fYnRuYCk7XG4gICAgICBkZWxldGVCdG4udGV4dENvbnRlbnQgPSBgWGA7XG4gICAgICBkZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCAoKSA9PiB7XG4gICAgICAgIGRlbGV0ZUV4cGVuc2UoaWQpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEHDsWFkaXIgZWwgYm90w7NuIGFsIExpXG4gICAgICBleHBlbnNlSXRlbS5hcHBlbmRDaGlsZChkZWxldGVCdG4pO1xuXG4gICAgICAvLyBBw7FhZGlyIGVsIExpIGFsIFVsXG4gICAgICBleHBlbnNlc0xpc3QuYXBwZW5kQ2hpbGQoZXhwZW5zZUl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgY2xlYW5IdG1sKCkge1xuICAgIHdoaWxlIChleHBlbnNlc0xpc3QuZmlyc3RDaGlsZCkge1xuICAgICAgZXhwZW5zZXNMaXN0LnJlbW92ZUNoaWxkKGV4cGVuc2VzTGlzdC5maXJzdENoaWxkKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVBdmFpbGFibGVCdWRnZXQoYXZhaWxhYmxlLCBzcGVudCkge1xuICAgIGxldCBmb3JtYXR0ZWRBdmFpbGFibGUgPSBhdmFpbGFibGUudG9Mb2NhbGVTdHJpbmcoXCJlcy1NWFwiLCB7XG4gICAgICBzdHlsZTogXCJjdXJyZW5jeVwiLFxuICAgICAgY3VycmVuY3k6IFwiTVhOXCIsXG4gICAgfSk7XG4gICAgbGV0IGZvcm1hdHRlZFNwZW50ID0gc3BlbnQudG9Mb2NhbGVTdHJpbmcoXCJlcy1NWFwiLCB7XG4gICAgICBzdHlsZTogXCJjdXJyZW5jeVwiLFxuICAgICAgY3VycmVuY3k6IFwiTVhOXCIsXG4gICAgfSk7XG5cbiAgICAvLyBBY3R1YWxpemFyIGVsIGRpc3BvbmlibGUgeSBlbCBnYXN0YWRvIGVuIGVsIEhUTUxcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNidWRnZXRDYXJkQXZhaWxhYmxlYFxuICAgICkudGV4dENvbnRlbnQgPSBgJHtmb3JtYXR0ZWRBdmFpbGFibGV9YDtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNidWRnZXRDYXJkU3BlbnRgXG4gICAgKS50ZXh0Q29udGVudCA9IGAke2Zvcm1hdHRlZFNwZW50fWA7XG4gIH1cblxuICBjaGVja0J1ZGdldChidWRnZXRPYmopIHtcbiAgICBjb25zdCB7IGJ1ZGdldFRvdGFsLCBidWRnZXRBdmFpbGFibGUgfSA9IGJ1ZGdldE9iajtcblxuICAgIC8qICAgaWYgKGJ1ZGdldFRvdGFsIC8gNCA+IGJ1ZGdldEF2YWlsYWJsZSkge1xuICAgICAgY29uc29sZS5sb2coYEdhc3Rhc3RlIGVsIDc1JWApO1xuICAgIH0gZWxzZSBpZiAoYnVkZ2V0VG90YWwgLyAyID4gYnVkZ2V0QXZhaWxhYmxlKSB7XG4gICAgICBjb25zb2xlLmxvZyhgR2FzdGFzdGUgZWwgNTAlYCk7XG4gICAgfSAqL1xuXG4gICAgY29uc3QgYnVkZ2V0Rm9ybUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5idWRnZXQtZm9ybV9fYnRuYCk7XG5cbiAgICAvLyBEZXNhY3RpdmFyIGVsIGJvdMOzbiBkZSBhZ3JlZ2FyIGdhc3RvIHNpIGVsIHByZXN1cHVlc3RvIGVzdMOhIGFnb3RhZG9cbiAgICBpZiAoYnVkZ2V0QXZhaWxhYmxlIDw9IDApIHtcbiAgICAgIHVzZXJJbnRlcmZhY2UucHJpbnRBbGVydHMoYEVsIHByZXN1cHVlc3RvIHNlIGhhIGFnb3RhZG9gLCBgZXJyb3JgKTtcbiAgICAgIGJ1ZGdldEZvcm1CdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBidWRnZXRGb3JtQnRuLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG59XG5cbi8qIEluc3RhbmNpYXMgKi9cbmxldCBidWRnZXQ7XG5jb25zdCB1c2VySW50ZXJmYWNlID0gbmV3IFVzZXJJbnRlcmZhY2UoKTtcblxuLyogRnVuY2lvbmVzICovXG5cbmZ1bmN0aW9uIGxvYWRMb2NhbFN0b3JhZ2UoKSB7XG4gIGxldCB1c2VyTmFtZSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oYHVzZXJuYW1lYCkpO1xuICBidWRnZXQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBidWRnZXRgKSk7XG5cbiAgLy8gU2kgdXNlck5hbWUgbm8gZXhpc3RlLCBwaWRlIGVsIG5vbWJyZSBkZSB1c3VhcmlvXG4gIGlmICghdXNlck5hbWUpIHtcbiAgICByZXF1ZXN0TmFtZSh1c2VyTmFtZSk7XG4gIH0gZWxzZSB7XG4gICAgLy8gQ2FyZ2FyIGVsIG5vbWJyZSBkZSB1c3VhcmlvIGVuIGxhIFVJXG4gICAgdXNlckludGVyZmFjZS5pbnNlcnROYW1lKHVzZXJOYW1lKTtcbiAgfVxuXG4gIC8vIFNpIG5vIGV4aXN0ZSB1biBwcmVzdXB1ZXN0bywgcGlkZSB1biBwcmVzdXB1ZXN0b1xuICBpZiAoIWJ1ZGdldCkge1xuICAgIHJlcXVlc3RCdWRnZXQoKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBJbnN0YW5jaWFyIGxhIGNsYXNlIEJ1ZGdldFxuICAgIGJ1ZGdldCA9IG5ldyBCdWRnZXQoYnVkZ2V0LmJ1ZGdldFRvdGFsKTtcblxuICAgIC8vIENhcmdhciBlbCBwcmVzdXB1ZXN0byBlbiBsYSBpbnRlcmZhelxuICAgIHVzZXJJbnRlcmZhY2UuaW5zZXJ0QnVkZ2V0KGJ1ZGdldCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVxdWVzdE5hbWUodXNlck5hbWUpIHtcbiAgLy8gU29saWNpdGFyIGVsIG5vbWJyZSBkZWwgdXN1YXJpbyBoYXN0YSBxdWUgc2UgaW5ncmVzZSB1biB2YWxvciB2w6FsaWRvXG4gIGRvIHtcbiAgICB1c2VyTmFtZSA9IHByb21wdChgwr9DdcOhbCBlcyB0dSBub21icmU/YCk7XG5cbiAgICAvLyBWYWxpZGFyIGVsIG5vbWJyZVxuICAgIGlmICghdXNlck5hbWUpIHtcbiAgICAgIGFsZXJ0KGBQb3IgZmF2b3IsIGludHJvZHVjZSB1biBub21icmUgdsOhbGlkby5gKTtcbiAgICB9XG4gIH0gd2hpbGUgKCF1c2VyTmFtZSk7XG5cbiAgLy8gTGxhbWFyIGFsIG3DqXRvZG8gcGFyYSBpbnNlcnRhciBlbCBub21icmUgZW4gbGEgVUlcbiAgdXNlckludGVyZmFjZS5pbnNlcnROYW1lKHVzZXJOYW1lKTtcblxuICAvLyBHdWFyZGFyIGVsIG5vbWJyZSBlbiBlbCBMb2NhbFN0b3JhZ2VcbiAgc2F2ZVRvTG9jYWxTdG9yYWdlKGB1c2VybmFtZWAsIHVzZXJOYW1lKTtcbn1cblxuZnVuY3Rpb24gcmVxdWVzdEJ1ZGdldCgpIHtcbiAgY29uc3QgdXNlckJ1ZGdldCA9IE51bWJlcihwcm9tcHQoYMK/Q3XDoWwgZXMgdHUgcHJlc3VwdWVzdG8/YCkpO1xuICBjb25zdCB2b2lkVmFsdWUgPSBgYDtcblxuICBpZiAoXG4gICAgdXNlckJ1ZGdldCA9PT0gdm9pZFZhbHVlIHx8XG4gICAgdXNlckJ1ZGdldCA9PT0gbnVsbCB8fFxuICAgIGlzTmFOKHVzZXJCdWRnZXQpIHx8XG4gICAgdXNlckJ1ZGdldCA8PSAwXG4gICkge1xuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgfVxuXG4gIC8vIENyZWFyIGluc3RhbmNpYSBkZSBcIkJ1ZGdldFwiIHkgZXN0YWJsZWNlcmxvXG4gIGJ1ZGdldCA9IG5ldyBCdWRnZXQodXNlckJ1ZGdldCk7XG5cbiAgLy8gTGxhbWFyIGFsIG3DqXRvZG8gcGFyYSBpbnNlcnRhciBlbCBwcmVzdXB1ZXN0byBlbiBsYSBVSVxuICB1c2VySW50ZXJmYWNlLmluc2VydEJ1ZGdldChidWRnZXQpO1xuXG4gIC8vIEd1YXJkYXIgZWwgb2JqZXRvIGRlIHByZXN1cHVlc3RvIGVuIGVsIGxvY2FsU3RvcmFnZVxuICBzYXZlVG9Mb2NhbFN0b3JhZ2UoYGJ1ZGdldGAsIGJ1ZGdldCk7XG59XG5cbmZ1bmN0aW9uIGJ1ZGdldEZvcm1FdmVudHMoKSB7XG4gIC8vIE9idGVuZXIgZWwgZm9ybXVsYXJpbyB5IHN1cyBldmVudG9zXG4gIGNvbnN0IGJ1ZGdldEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjYnVkZ2V0Rm9ybWApO1xuICBidWRnZXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoYHN1Ym1pdGAsIGFkZEV4cGVuc2UpO1xufVxuXG5mdW5jdGlvbiBhZGRFeHBlbnNlKGUpIHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIC8vIE9idGVuZXIgbG9zIHZhbG9yZXMgZGVsIGZvcm11bGFyaW9cbiAgY29uc3QgaW5wdXROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2J1ZGdldEZvcm1OYW1lYCkudmFsdWU7XG4gIGNvbnN0IGlucHV0QW1vdW50ID0gTnVtYmVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNidWRnZXRGb3JtQW1vdW50YCkudmFsdWUpO1xuICBjb25zdCBzZWxlY3RlZENhdGVnb3J5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2J1ZGdldEZvcm1DYXRlZ29yeWApLnZhbHVlO1xuICBsZXQgdm9pZFZhbHVlID0gYGA7XG5cbiAgLy8gVmFsaWRhciBxdWUgbmluZ3VubyBkZSBsb3MgY2FtcG9zIGVzdMOpIHZhY8Otb1xuICBpZiAoXG4gICAgaW5wdXROYW1lID09PSB2b2lkVmFsdWUgfHxcbiAgICBpbnB1dEFtb3VudCA9PT0gdm9pZFZhbHVlIHx8XG4gICAgc2VsZWN0ZWRDYXRlZ29yeSA9PT0gdm9pZFZhbHVlXG4gICkge1xuICAgIHVzZXJJbnRlcmZhY2UucHJpbnRBbGVydHMoYFRvZG9zIGxvcyBjYW1wb3Mgc29uIG9ibGlnYXRvcmlvc2AsIGBlcnJvcmApO1xuXG4gICAgcmV0dXJuO1xuICB9IGVsc2UgaWYgKGlucHV0QW1vdW50IDw9IDAgfHwgaXNOYU4oaW5wdXRBbW91bnQpKSB7XG4gICAgdXNlckludGVyZmFjZS5wcmludEFsZXJ0cyhgQ2FudGlkYWQgbm8gdmFsaWRhYCwgYGVycm9yYCk7XG5cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBDcmVhciBvYmpldG8gY29uIGVsIGdhc3RvXG4gIGNvbnN0IGV4cGVuc2UgPSB7IGlucHV0TmFtZSwgaW5wdXRBbW91bnQsIHNlbGVjdGVkQ2F0ZWdvcnksIGlkOiBEYXRlLm5vdygpIH07XG5cbiAgLy8gQcOxYWRpciBlbCBnYXN0byBhIGxhIGxpc3RhIHkgYWwgcHJlc3VwdWVzdG9cbiAgYnVkZ2V0Lm5ld0V4cGVuc2VzKGV4cGVuc2UpO1xuXG4gIC8vIE9idGVuZXIgbG9zIHZhbG9yZXMgYWN0dWFsZXMgZGVsIHByZXN1cHVlc3RvIHkgZ2FzdG9cbiAgY29uc3QgeyBleHBlbnNlcywgYnVkZ2V0QXZhaWxhYmxlLCBidWRnZXRTcGVudCB9ID0gYnVkZ2V0O1xuXG4gIC8vIEltcHJpbWlyIGVsIGdhc3RvIGVuIGVsIEhUTUxcbiAgdXNlckludGVyZmFjZS5zaG93RXhwZW5zZUxpc3QoZXhwZW5zZXMpO1xuXG4gIC8vIEFjdHVhbGl6YXIgZWwgcHJlc3VwdWVzdG8gZW4gbGEgVUlcbiAgdXNlckludGVyZmFjZS51cGRhdGVBdmFpbGFibGVCdWRnZXQoYnVkZ2V0QXZhaWxhYmxlLCBidWRnZXRTcGVudCk7XG5cbiAgLy8gTGxhbWFyIGFsIG3DqXRvZG8gcGFyYSBjb21wcm9iYXIgc2kgc2UgaGEgYWxjYW56YWRvIGVsIHByZXN1cHVlc3RvXG4gIHVzZXJJbnRlcmZhY2UuY2hlY2tCdWRnZXQoYnVkZ2V0KTtcblxuICAvLyBMaW1waWFyIGxvcyBjYW1wb3MgZGVsIGZvcm11bGFyaW9cbiAgY29uc3QgYnVkZ2V0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNidWRnZXRGb3JtYCk7XG4gIGJ1ZGdldEZvcm0ucmVzZXQoKTtcblxuICAvLyBHdWFyZGEgZWwgb2JqZXRvIGJ1ZGdldCBhY3R1YWxpemFkbyBlbiBlbCBsb2NhbFN0b3JhZ2VcbiAgc2F2ZVRvTG9jYWxTdG9yYWdlKGBidWRnZXRgLCBidWRnZXQpO1xufVxuXG5mdW5jdGlvbiBkZWxldGVFeHBlbnNlKGlkKSB7XG4gIC8vIEVsaW1pbmFyIGVsIGdhc3RvIGRlbCBvYmpldG9cbiAgYnVkZ2V0LmRlbGV0ZUV4cGVuc2UoaWQpO1xuXG4gIC8vIE9idGVuZXIgbG9zIHZhbG9yZXMgYWN0dWFsZXMgZGVsIHByZXN1cHVlc3RvIHkgZ2FzdG9cbiAgY29uc3QgeyBleHBlbnNlcywgYnVkZ2V0QXZhaWxhYmxlLCBidWRnZXRTcGVudCB9ID0gYnVkZ2V0O1xuXG4gIC8vIEVsaW1pbmFyIGVsIGdhc3RvIGRlbCBIVE1MXG4gIHVzZXJJbnRlcmZhY2Uuc2hvd0V4cGVuc2VMaXN0KGV4cGVuc2VzKTtcblxuICAvLyBBY3R1YWxpemFyIGVsIHByZXN1cHVlc3RvIGVuIGxhIFVJXG4gIHVzZXJJbnRlcmZhY2UudXBkYXRlQXZhaWxhYmxlQnVkZ2V0KGJ1ZGdldEF2YWlsYWJsZSwgYnVkZ2V0U3BlbnQpO1xuXG4gIC8vIExsYW1hciBhbCBtw6l0b2RvIHBhcmEgY29tcHJvYmFyIHNpIHNlIGhhIGFsY2FuemFkbyBlbCBwcmVzdXB1ZXN0b1xuICB1c2VySW50ZXJmYWNlLmNoZWNrQnVkZ2V0KGJ1ZGdldCk7XG5cbiAgLy8gR3VhcmRhIGVsIG9iamV0byBidWRnZXQgYWN0dWFsaXphZG8gZW4gZWwgbG9jYWxTdG9yYWdlXG4gIHNhdmVUb0xvY2FsU3RvcmFnZShgYnVkZ2V0YCwgYnVkZ2V0KTtcbn1cblxuZnVuY3Rpb24gc2F2ZVRvTG9jYWxTdG9yYWdlKGtleSwgdmFsdWUpIHtcbiAgLy8gR3VhcmRhciBkYXRvcyBlbiBlbCBMb2NhbFN0b3JhZ2VcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO1xufVxuIl19
