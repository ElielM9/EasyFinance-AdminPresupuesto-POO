const expensesList=document.querySelector("#expensesList");let budget;function startApp(){loadLocalStorage(),budgetFormEvents()}document.addEventListener("DOMContentLoaded",startApp);class Budget{constructor(e){this.budgetTotal=e,this.budgetAvailable=e,this.budgetSpent=0,this.expenses=[]}newExpenses(e){e.inputAmount>this.budgetAvailable?userInterface.printAlerts("No tienes fondos suficientes","error"):(this.expenses=[...this.expenses,e],this.calculateSpent(),userInterface.printAlerts("Se agregó correctamente","success"))}calculateSpent(){this.budgetSpent=this.expenses.reduce((e,t)=>e+t.inputAmount,0),this.budgetAvailable=this.budgetTotal-this.budgetSpent}deleteExpense(e){const t=this.expenses.filter(t=>t.id!==e);this.expenses=t,this.calculateSpent()}}class UserInterface{insertName(e){document.querySelector(".budget__heading--user-name").textContent=e+"!"}insertBudget(e){const{budgetTotal:t,budgetAvailable:n,budgetSpent:r}=e;let s=t.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),u=n.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),o=r.toLocaleString("es-MX",{style:"currency",currency:"MXN"});document.querySelector("#budgetCardTotal").textContent=""+s,document.querySelector("#budgetCardAvailable").textContent=""+u,document.querySelector("#budgetCardSpent").textContent=""+o}printAlerts(e,t){let n=document.querySelector(".alert--"+t);if(n)return void(n.textContent=e);const r=document.createElement("p");r.classList.add("alert"),"error"===t?r.classList.add("alert--error"):r.classList.add("alert--success"),r.textContent=e;document.querySelector("#budgetForm").appendChild(r),setTimeout(()=>{r.remove()},2e3)}showExpenseList(e){this.cleanHtml(),e.forEach(e=>{const{inputName:t,inputAmount:n,selectedCategory:r,id:s}=e,u=n.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),o=document.createElement("li");o.className="expense-item",o.dataset.id=s,o.dataset.category=r,o.innerHTML=`\n        <div class="expense-item__texts">\n          <p class="expense-item__description">${t}</p>\n          <p class="expense-item__price">${u}</p>\n        </div>\n      `;const a=document.createElement("button");a.classList.add("expense-item__btn"),a.textContent="X",a.addEventListener("click",()=>{deleteExpense(s)}),o.appendChild(a),expensesList.appendChild(o)})}cleanHtml(){for(;expensesList.firstChild;)expensesList.removeChild(expensesList.firstChild)}updateAvailableBudget(e,t){let n=e.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),r=t.toLocaleString("es-MX",{style:"currency",currency:"MXN"});document.querySelector("#budgetCardAvailable").textContent=""+n,document.querySelector("#budgetCardSpent").textContent=""+r}checkBudget(e){const{budgetTotal:t,budgetAvailable:n}=e,r=document.querySelector(".budget-form__btn");n<=0?(userInterface.printAlerts("El presupuesto se ha agotado","error"),r.disabled=!0):r.disabled=!1}}const userInterface=new UserInterface;function loadLocalStorage(){let e=JSON.parse(localStorage.getItem("username"));budget=JSON.parse(localStorage.getItem("budget")),e?userInterface.insertName(e):requestName(e),budget?userInterface.insertBudget(budget):requestBudget()}function requestName(e){do{(e=prompt("¿Cuál es tu nombre?"))||alert("Por favor, introduce un nombre válido.")}while(!e);userInterface.insertName(e),saveToLocalStorage("username",e)}function requestBudget(){const e=Number(prompt("¿Cuál es tu presupuesto?"));(""===e||null===e||isNaN(e)||e<=0)&&window.location.reload(),budget=new Budget(e),userInterface.insertBudget(budget),saveToLocalStorage("budget",budget)}function budgetFormEvents(){document.querySelector("#budgetForm").addEventListener("submit",addExpense)}function addExpense(e){e.preventDefault();const t=document.querySelector("#budgetFormName").value,n=Number(document.querySelector("#budgetFormAmount").value),r=document.querySelector("#budgetFormCategory").value;if(""===t||""===n||""===r)return void userInterface.printAlerts("Todos los campos son obligatorios","error");if(n<=0||isNaN(n))return void userInterface.printAlerts("Cantidad no valida","error");const s={inputName:t,inputAmount:n,selectedCategory:r,id:Date.now()};budget.newExpenses(s);const{expenses:u,budgetAvailable:o,budgetSpent:a}=budget;userInterface.showExpenseList(u),userInterface.updateAvailableBudget(o,a),userInterface.checkBudget(budget);document.querySelector("#budgetForm").reset()}function deleteExpense(e){budget.deleteExpense(e);const{expenses:t,budgetAvailable:n,budgetSpent:r}=budget;userInterface.showExpenseList(t),userInterface.updateAvailableBudget(n,r),userInterface.checkBudget(budget)}function saveToLocalStorage(e,t){localStorage.setItem(""+e,JSON.stringify(t))}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZXhwZW5zZXNMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYnVkZ2V0Iiwic3RhcnRBcHAiLCJsb2FkTG9jYWxTdG9yYWdlIiwiYnVkZ2V0Rm9ybUV2ZW50cyIsImFkZEV2ZW50TGlzdGVuZXIiLCJCdWRnZXQiLCJbb2JqZWN0IE9iamVjdF0iLCJidWRnZXRUb3RhbCIsInRoaXMiLCJidWRnZXRBdmFpbGFibGUiLCJidWRnZXRTcGVudCIsImV4cGVuc2VzIiwiZXhwZW5zZSIsImlucHV0QW1vdW50IiwidXNlckludGVyZmFjZSIsInByaW50QWxlcnRzIiwiY2FsY3VsYXRlU3BlbnQiLCJyZWR1Y2UiLCJ0b3RhbCIsImV4cGVuc2VJZCIsImZpbHRlcmVkRXhwZW5zZXMiLCJmaWx0ZXIiLCJpZCIsIlVzZXJJbnRlcmZhY2UiLCJ1c2VyTmFtZSIsInRleHRDb250ZW50IiwicXVhbnRpdHkiLCJmb3JtYXR0ZWRUb3RhbCIsInRvTG9jYWxlU3RyaW5nIiwic3R5bGUiLCJjdXJyZW5jeSIsImZvcm1hdHRlZEF2YWlsYWJsZSIsImZvcm1hdHRlZFNwZW50IiwibWVzc2FnZSIsInR5cGVBbGVydCIsImV4aXN0aW5nQWxlcnQiLCJhbGVydE1lc3NhZ2UiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJzZXRUaW1lb3V0IiwicmVtb3ZlIiwiY2xlYW5IdG1sIiwiZm9yRWFjaCIsImlucHV0TmFtZSIsInNlbGVjdGVkQ2F0ZWdvcnkiLCJmb3JtYXR0ZWRBbW91bnQiLCJleHBlbnNlSXRlbSIsImNsYXNzTmFtZSIsImRhdGFzZXQiLCJjYXRlZ29yeSIsImlubmVySFRNTCIsImRlbGV0ZUJ0biIsImRlbGV0ZUV4cGVuc2UiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJhdmFpbGFibGUiLCJzcGVudCIsImJ1ZGdldE9iaiIsImJ1ZGdldEZvcm1CdG4iLCJkaXNhYmxlZCIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJpbnNlcnROYW1lIiwicmVxdWVzdE5hbWUiLCJpbnNlcnRCdWRnZXQiLCJyZXF1ZXN0QnVkZ2V0IiwicHJvbXB0IiwiYWxlcnQiLCJzYXZlVG9Mb2NhbFN0b3JhZ2UiLCJ1c2VyQnVkZ2V0IiwiTnVtYmVyIiwiaXNOYU4iLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsImFkZEV4cGVuc2UiLCJlIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsIkRhdGUiLCJub3ciLCJuZXdFeHBlbnNlcyIsInNob3dFeHBlbnNlTGlzdCIsInVwZGF0ZUF2YWlsYWJsZUJ1ZGdldCIsImNoZWNrQnVkZ2V0IiwicmVzZXQiLCJrZXkiLCJzZXRJdGVtIiwic3RyaW5naWZ5Il0sIm1hcHBpbmdzIjoiQUFDQSxNQUFNQSxhQUFlQyxTQUFTQyxjQUFjLGlCQUM1QyxJQUFJQyxPQUtKLFNBQVNDLFdBQ1BDLG1CQUNBQyxtQkFKRkwsU0FBU00saUJBQWlCLG1CQUFvQkgsVUFROUMsTUFBTUksT0FDSkMsWUFBWUMsR0FDVkMsS0FBS0QsWUFBY0EsRUFDbkJDLEtBQUtDLGdCQUFrQkYsRUFDdkJDLEtBQUtFLFlBQWMsRUFDbkJGLEtBQUtHLFNBQVcsR0FHbEJMLFlBQVlNLEdBRU5BLEVBQVFDLFlBQWNMLEtBQUtDLGdCQUM3QkssY0FBY0MsWUFBWSwrQkFBZ0MsVUFNNURQLEtBQUtHLFNBQVcsSUFBSUgsS0FBS0csU0FBVUMsR0FDbkNKLEtBQUtRLGlCQUdMRixjQUFjQyxZQUFZLDBCQUEyQixZQUd2RFQsaUJBQ0VFLEtBQUtFLFlBQWNGLEtBQUtHLFNBQVNNLE9BQy9CLENBQUNDLEVBQU9OLElBQVlNLEVBQVFOLEVBQVFDLFlBQ3BDLEdBRUZMLEtBQUtDLGdCQUFrQkQsS0FBS0QsWUFBY0MsS0FBS0UsWUFHakRKLGNBQWNhLEdBRVosTUFBTUMsRUFBbUJaLEtBQUtHLFNBQVNVLE9BQ3BDVCxHQUFZQSxFQUFRVSxLQUFPSCxHQUk5QlgsS0FBS0csU0FBV1Ms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QyxHQUdyQixNQUFNWCxTQUFFQSxFQUFRRixnQkFBRUEsRUFBZUMsWUFBRUEsR0FBZ0JWLE9BR25EYyxjQUFjd0UsZ0JBQWdCM0UsR0FHOUJHLGNBQWN5RSxzQkFBc0I5RSxFQUFpQkMsR0FHckRJLGNBQWMwRSxZQUFZeEYsUUFHNUIsU0FBU3dFLG1CQUFtQmtCLEVBQUtSLEdBRS9CbEIsYUFBYTJCLFFBQVEsR0FBR0QsRUFBTzVCLEtBQUs4QixVQUFVViIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogVmFyaWFibGVzIHkgc2VsZWN0b3JlcyAqL1xuY29uc3QgZXhwZW5zZXNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2V4cGVuc2VzTGlzdGApO1xubGV0IGJ1ZGdldDtcblxuLyogRXZlbnRvcyAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihgRE9NQ29udGVudExvYWRlZGAsIHN0YXJ0QXBwKTtcblxuZnVuY3Rpb24gc3RhcnRBcHAoKSB7XG4gIGxvYWRMb2NhbFN0b3JhZ2UoKTtcbiAgYnVkZ2V0Rm9ybUV2ZW50cygpO1xufVxuXG4vKiBDbGFzZXMgKi9cbmNsYXNzIEJ1ZGdldCB7XG4gIGNvbnN0cnVjdG9yKGJ1ZGdldFRvdGFsKSB7XG4gICAgdGhpcy5idWRnZXRUb3RhbCA9IGJ1ZGdldFRvdGFsO1xuICAgIHRoaXMuYnVkZ2V0QXZhaWxhYmxlID0gYnVkZ2V0VG90YWw7XG4gICAgdGhpcy5idWRnZXRTcGVudCA9IDA7XG4gICAgdGhpcy5leHBlbnNlcyA9IFtdO1xuICB9XG5cbiAgbmV3RXhwZW5zZXMoZXhwZW5zZSkge1xuICAgIC8vIFZhbGlkYXIgcXVlIGVsIG1vbnRvIGludHJvZHVjaWRvIG5vIHNlYSBtYXlvciBhbCBwcmVzdXB1ZXN0byBkaXNwb25pYmxlXG4gICAgaWYgKGV4cGVuc2UuaW5wdXRBbW91bnQgPiB0aGlzLmJ1ZGdldEF2YWlsYWJsZSkge1xuICAgICAgdXNlckludGVyZmFjZS5wcmludEFsZXJ0cyhgTm8gdGllbmVzIGZvbmRvcyBzdWZpY2llbnRlc2AsIGBlcnJvcmApO1xuXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQcOxYWRpciBlbCBnYXN0byBhIGxhIGxpc3RhIGRlIGdhc3Rvc1xuICAgIHRoaXMuZXhwZW5zZXMgPSBbLi4udGhpcy5leHBlbnNlcywgZXhwZW5zZV07XG4gICAgdGhpcy5jYWxjdWxhdGVTcGVudCgpO1xuXG4gICAgLy8gSW1wcmltaXIgdW5hIGFsZXJ0YSBkZSBleGl0b1xuICAgIHVzZXJJbnRlcmZhY2UucHJpbnRBbGVydHMoYFNlIGFncmVnw7MgY29ycmVjdGFtZW50ZWAsIGBzdWNjZXNzYCk7XG4gIH1cblxuICBjYWxjdWxhdGVTcGVudCgpIHtcbiAgICB0aGlzLmJ1ZGdldFNwZW50ID0gdGhpcy5leHBlbnNlcy5yZWR1Y2UoXG4gICAgICAodG90YWwsIGV4cGVuc2UpID0+IHRvdGFsICsgZXhwZW5zZS5pbnB1dEFtb3VudCxcbiAgICAgIDBcbiAgICApO1xuICAgIHRoaXMuYnVkZ2V0QXZhaWxhYmxlID0gdGhpcy5idWRnZXRUb3RhbCAtIHRoaXMuYnVkZ2V0U3BlbnQ7XG4gIH1cblxuICBkZWxldGVFeHBlbnNlKGV4cGVuc2VJZCkge1xuICAgIC8vIEZpbHRyYXIgbG9zIGdhc3RvcyBxdWUgbm8gdGllbmVuIGVsIGlkIGRlIGV4cGVuc2VzSWRcbiAgICBjb25zdCBmaWx0ZXJlZEV4cGVuc2VzID0gdGhpcy5leHBlbnNlcy5maWx0ZXIoXG4gICAgICAoZXhwZW5zZSkgPT4gZXhwZW5zZS5pZCAhPT0gZXhwZW5zZUlkXG4gICAgKTtcblxuICAgIC8vIEFjdHVhbGl6YXIgZWwgYXJyYXkgZGUgZ2FzdG9zXG4gICAgdGhpcy5leHBlbnNlcyA9IGZpbHRlcmVkRXhwZW5zZXM7XG5cbiAgICAvLyBSZWNhbGN1bGFyIGVsIHByZXN1cHVlc3RvIGRpc3BvbmlibGUgeSBnYXN0YWRvXG4gICAgdGhpcy5jYWxjdWxhdGVTcGVudCgpO1xuICB9XG59XG5cbmNsYXNzIFVzZXJJbnRlcmZhY2Uge1xuICBpbnNlcnROYW1lKHVzZXJOYW1lKSB7XG4gICAgY29uc3QgYnVkZ2V0VXNlck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC5idWRnZXRfX2hlYWRpbmctLXVzZXItbmFtZWBcbiAgICApO1xuXG4gICAgLy8gSW5zZXJ0YXIgZWwgbm9tYnJlIGRlbCB1c3VhcmlvIGVuIGVsIEhUTUxcbiAgICBidWRnZXRVc2VyTmFtZS50ZXh0Q29udGVudCA9IGAke3VzZXJOYW1lfSFgO1xuICB9XG5cbiAgaW5zZXJ0QnVkZ2V0KHF1YW50aXR5KSB7XG4gICAgY29uc3QgeyBidWRnZXRUb3RhbCwgYnVkZ2V0QXZhaWxhYmxlLCBidWRnZXRTcGVudCB9ID0gcXVhbnRpdHk7XG5cbiAgICAvLyBGb3JtYXRlYXIgZWwgdG90YWwgeSBkaXNwb25pYmxlIGVuIG1vbmVkYSBsb2NhbCBNWE5cbiAgICBsZXQgZm9ybWF0dGVkVG90YWwgPSBidWRnZXRUb3RhbC50b0xvY2FsZVN0cmluZyhcImVzLU1YXCIsIHtcbiAgICAgIHN0eWxlOiBcImN1cnJlbmN5XCIsXG4gICAgICBjdXJyZW5jeTogXCJNWE5cIixcbiAgICB9KTtcbiAgICBsZXQgZm9ybWF0dGVkQXZhaWxhYmxlID0gYnVkZ2V0QXZhaWxhYmxlLnRvTG9jYWxlU3RyaW5nKFwiZXMtTVhcIiwge1xuICAgICAgc3R5bGU6IFwiY3VycmVuY3lcIixcbiAgICAgIGN1cnJlbmN5OiBcIk1YTlwiLFxuICAgIH0pO1xuICAgIGxldCBmb3JtYXR0ZWRTcGVudCA9IGJ1ZGdldFNwZW50LnRvTG9jYWxlU3RyaW5nKFwiZXMtTVhcIiwge1xuICAgICAgc3R5bGU6IFwiY3VycmVuY3lcIixcbiAgICAgIGN1cnJlbmN5OiBcIk1YTlwiLFxuICAgIH0pO1xuXG4gICAgLy8gSW5zZXJ0YXIgZWwgdG90YWwgeSBkaXNwb25pYmxlIGVuIGVsIEhUTUxcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNidWRnZXRDYXJkVG90YWxgXG4gICAgKS50ZXh0Q29udGVudCA9IGAke2Zvcm1hdHRlZFRvdGFsfWA7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjYnVkZ2V0Q2FyZEF2YWlsYWJsZWBcbiAgICApLnRleHRDb250ZW50ID0gYCR7Zm9ybWF0dGVkQXZhaWxhYmxlfWA7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjYnVkZ2V0Q2FyZFNwZW50YFxuICAgICkudGV4dENvbnRlbnQgPSBgJHtmb3JtYXR0ZWRTcGVudH1gO1xuICB9XG5cbiAgcHJpbnRBbGVydHMobWVzc2FnZSwgdHlwZUFsZXJ0KSB7XG4gICAgLy8gTGltcGlhciBsYXMgYWxlcnRhcyBhbnRlcmlvcmVzIHBhcmEgZXZpdGFyIGR1cGxpY2Fkb3MuXG4gICAgbGV0IGV4aXN0aW5nQWxlcnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuYWxlcnQtLSR7dHlwZUFsZXJ0fWApO1xuXG4gICAgLy8gU2kgaGF5IHVuYSBhbGVydGEgZGVsIG1pc21vIHRpcG8sIGFjdHVhbGl6YXIgZWwgbWVuc2FqZSB5IG5vIGFncmVnYXIgdW5vIG51ZXZvXG4gICAgaWYgKGV4aXN0aW5nQWxlcnQpIHtcbiAgICAgIGV4aXN0aW5nQWxlcnQudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ3JlYXIgZWwgZGl2IGRlIGxhIGFsZXJ0YVxuICAgIGNvbnN0IGFsZXJ0TWVzc2FnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYHBgKTtcbiAgICBhbGVydE1lc3NhZ2UuY2xhc3NMaXN0LmFkZChgYWxlcnRgKTtcblxuICAgIC8vIEFncmVnYXIgZWwgbWVuc2FqZSB5IGVsIHRpcG8gZGUgYWxlcnRhIGFsIHAgZGUgbGEgYWxlcnRhXG4gICAgaWYgKHR5cGVBbGVydCA9PT0gYGVycm9yYCkge1xuICAgICAgYWxlcnRNZXNzYWdlLmNsYXNzTGlzdC5hZGQoYGFsZXJ0LS1lcnJvcmApO1xuICAgIH0gZWxzZSB7XG4gICAgICBhbGVydE1lc3NhZ2UuY2xhc3NMaXN0LmFkZChgYWxlcnQtLXN1Y2Nlc3NgKTtcbiAgICB9XG5cbiAgICAvLyBBZ3JlZ2FyIGFsIGRpdiBlbCBtZW5zYWplXG4gICAgYWxlcnRNZXNzYWdlLnRleHRDb250ZW50ID0gbWVzc2FnZTtcblxuICAgIC8vIEluc2VydGFyIGxhIGFsZXJ0YSBhbCBIVE1MXG4gICAgY29uc3QgYnVkZ2V0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNidWRnZXRGb3JtYCk7XG4gICAgYnVkZ2V0Rm9ybS5hcHBlbmRDaGlsZChhbGVydE1lc3NhZ2UpO1xuXG4gICAgLy8gRWxpbWluYXIgbGEgYWxlcnRhIGRlc3B1w6lzIGRlIDMgc2VndW5kb3NcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGFsZXJ0TWVzc2FnZS5yZW1vdmUoKTtcbiAgICB9LCAyMDAwKTtcbiAgfVxuXG4gIHNob3dFeHBlbnNlTGlzdChleHBlbnNlcykge1xuICAgIC8vIExpbXBpYXIgbGEgbGlzdGEgZGUgZ2FzdG9zXG4gICAgdGhpcy5jbGVhbkh0bWwoKTtcblxuICAgIC8vIEl0ZXJhciBsb3MgZ2FzdG9zXG4gICAgZXhwZW5zZXMuZm9yRWFjaCgoZXhwZW5zZSkgPT4ge1xuICAgICAgY29uc3QgeyBpbnB1dE5hbWUsIGlucHV0QW1vdW50LCBzZWxlY3RlZENhdGVnb3J5LCBpZCB9ID0gZXhwZW5zZTtcblxuICAgICAgLy8gRm9ybWF0ZWFyIGxhIGNhbnRpZGFkXG4gICAgICBjb25zdCBmb3JtYXR0ZWRBbW91bnQgPSBpbnB1dEFtb3VudC50b0xvY2FsZVN0cmluZyhcImVzLU1YXCIsIHtcbiAgICAgICAgc3R5bGU6IFwiY3VycmVuY3lcIixcbiAgICAgICAgY3VycmVuY3k6IFwiTVhOXCIsXG4gICAgICB9KTtcblxuICAgICAgLy8gQ3JlYXIgZWwgTGlcbiAgICAgIGNvbnN0IGV4cGVuc2VJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgbGlgKTtcbiAgICAgIGV4cGVuc2VJdGVtLmNsYXNzTmFtZSA9IGBleHBlbnNlLWl0ZW1gO1xuICAgICAgZXhwZW5zZUl0ZW0uZGF0YXNldC5pZCA9IGlkO1xuICAgICAgZXhwZW5zZUl0ZW0uZGF0YXNldC5jYXRlZ29yeSA9IHNlbGVjdGVkQ2F0ZWdvcnk7XG5cbiAgICAgIC8vIEFncmVnYXIgZWwgSFRNTFxuICAgICAgZXhwZW5zZUl0ZW0uaW5uZXJIVE1MID0gYFxuICAgICAgICA8ZGl2IGNsYXNzPVwiZXhwZW5zZS1pdGVtX190ZXh0c1wiPlxuICAgICAgICAgIDxwIGNsYXNzPVwiZXhwZW5zZS1pdGVtX19kZXNjcmlwdGlvblwiPiR7aW5wdXROYW1lfTwvcD5cbiAgICAgICAgICA8cCBjbGFzcz1cImV4cGVuc2UtaXRlbV9fcHJpY2VcIj4ke2Zvcm1hdHRlZEFtb3VudH08L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgYDtcblxuICAgICAgLy8gQm90w7NuIHBhcmEgYm9ycmFyIGVsIGdhc3RvXG4gICAgICBjb25zdCBkZWxldGVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGBidXR0b25gKTtcbiAgICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKGBleHBlbnNlLWl0ZW1fX2J0bmApO1xuICAgICAgZGVsZXRlQnRuLnRleHRDb250ZW50ID0gYFhgO1xuICAgICAgZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoYGNsaWNrYCwgKCkgPT4ge1xuICAgICAgICBkZWxldGVFeHBlbnNlKGlkKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBw7FhZGlyIGVsIGJvdMOzbiBhbCBMaVxuICAgICAgZXhwZW5zZUl0ZW0uYXBwZW5kQ2hpbGQoZGVsZXRlQnRuKTtcblxuICAgICAgLy8gQcOxYWRpciBlbCBMaSBhbCBVbFxuICAgICAgZXhwZW5zZXNMaXN0LmFwcGVuZENoaWxkKGV4cGVuc2VJdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsZWFuSHRtbCgpIHtcbiAgICB3aGlsZSAoZXhwZW5zZXNMaXN0LmZpcnN0Q2hpbGQpIHtcbiAgICAgIGV4cGVuc2VzTGlzdC5yZW1vdmVDaGlsZChleHBlbnNlc0xpc3QuZmlyc3RDaGlsZCk7XG4gICAgfVxuICB9XG5cbiAgdXBkYXRlQXZhaWxhYmxlQnVkZ2V0KGF2YWlsYWJsZSwgc3BlbnQpIHtcbiAgICBsZXQgZm9ybWF0dGVkQXZhaWxhYmxlID0gYXZhaWxhYmxlLnRvTG9jYWxlU3RyaW5nKFwiZXMtTVhcIiwge1xuICAgICAgc3R5bGU6IFwiY3VycmVuY3lcIixcbiAgICAgIGN1cnJlbmN5OiBcIk1YTlwiLFxuICAgIH0pO1xuICAgIGxldCBmb3JtYXR0ZWRTcGVudCA9IHNwZW50LnRvTG9jYWxlU3RyaW5nKFwiZXMtTVhcIiwge1xuICAgICAgc3R5bGU6IFwiY3VycmVuY3lcIixcbiAgICAgIGN1cnJlbmN5OiBcIk1YTlwiLFxuICAgIH0pO1xuXG4gICAgLy8gQWN0dWFsaXphciBlbCBkaXNwb25pYmxlIHkgZWwgZ2FzdGFkbyBlbiBlbCBIVE1MXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjYnVkZ2V0Q2FyZEF2YWlsYWJsZWBcbiAgICApLnRleHRDb250ZW50ID0gYCR7Zm9ybWF0dGVkQXZhaWxhYmxlfWA7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjYnVkZ2V0Q2FyZFNwZW50YFxuICAgICkudGV4dENvbnRlbnQgPSBgJHtmb3JtYXR0ZWRTcGVudH1gO1xuICB9XG5cbiAgY2hlY2tCdWRnZXQoYnVkZ2V0T2JqKSB7XG4gICAgY29uc3QgeyBidWRnZXRUb3RhbCwgYnVkZ2V0QXZhaWxhYmxlIH0gPSBidWRnZXRPYmo7XG5cbiAgICAvKiAgIGlmIChidWRnZXRUb3RhbCAvIDQgPiBidWRnZXRBdmFpbGFibGUpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBHYXN0YXN0ZSBlbCA3NSVgKTtcbiAgICB9IGVsc2UgaWYgKGJ1ZGdldFRvdGFsIC8gMiA+IGJ1ZGdldEF2YWlsYWJsZSkge1xuICAgICAgY29uc29sZS5sb2coYEdhc3Rhc3RlIGVsIDUwJWApO1xuICAgIH0gKi9cblxuICAgIGNvbnN0IGJ1ZGdldEZvcm1CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuYnVkZ2V0LWZvcm1fX2J0bmApO1xuXG4gICAgLy8gRGVzYWN0aXZhciBlbCBib3TDs24gZGUgYWdyZWdhciBnYXN0byBzaSBlbCBwcmVzdXB1ZXN0byBlc3TDoSBhZ290YWRvXG4gICAgaWYgKGJ1ZGdldEF2YWlsYWJsZSA8PSAwKSB7XG4gICAgICB1c2VySW50ZXJmYWNlLnByaW50QWxlcnRzKGBFbCBwcmVzdXB1ZXN0byBzZSBoYSBhZ290YWRvYCwgYGVycm9yYCk7XG4gICAgICBidWRnZXRGb3JtQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnVkZ2V0Rm9ybUJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxufVxuXG4vKiBJbnN0YW5jaWFzICovXG5jb25zdCB1c2VySW50ZXJmYWNlID0gbmV3IFVzZXJJbnRlcmZhY2UoKTtcblxuLyogRnVuY2lvbmVzICovXG5cbmZ1bmN0aW9uIGxvYWRMb2NhbFN0b3JhZ2UoKSB7XG4gIGxldCB1c2VyTmFtZSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oYHVzZXJuYW1lYCkpO1xuICBidWRnZXQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBidWRnZXRgKSk7XG5cbiAgLy8gU2kgdXNlck5hbWUgbm8gZXhpc3RlLCBwaWRlIGVsIG5vbWJyZSBkZSB1c3VhcmlvXG4gIGlmICghdXNlck5hbWUpIHtcbiAgICByZXF1ZXN0TmFtZSh1c2VyTmFtZSk7XG4gIH0gZWxzZSB7XG4gICAgLy8gQ2FyZ2FyIGVsIG5vbWJyZSBkZSB1c3VhcmlvIGVuIGxhIFVJXG4gICAgdXNlckludGVyZmFjZS5pbnNlcnROYW1lKHVzZXJOYW1lKTtcbiAgfVxuXG4gIC8vIFNpIG5vIGV4aXN0ZSB1biBwcmVzdXB1ZXN0bywgcGlkZSB1biBwcmVzdXB1ZXN0b1xuICBpZiAoIWJ1ZGdldCkge1xuICAgIHJlcXVlc3RCdWRnZXQoKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBDYXJnYXIgZWwgcHJlc3VwdWVzdG8gZW4gbGEgaW50ZXJmYXpcbiAgICB1c2VySW50ZXJmYWNlLmluc2VydEJ1ZGdldChidWRnZXQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlcXVlc3ROYW1lKHVzZXJOYW1lKSB7XG4gIC8vIFNvbGljaXRhciBlbCBub21icmUgZGVsIHVzdWFyaW8gaGFzdGEgcXVlIHNlIGluZ3Jlc2UgdW4gdmFsb3IgdsOhbGlkb1xuICBkbyB7XG4gICAgdXNlck5hbWUgPSBwcm9tcHQoYMK/Q3XDoWwgZXMgdHUgbm9tYnJlP2ApO1xuXG4gICAgLy8gVmFsaWRhciBlbCBub21icmVcbiAgICBpZiAoIXVzZXJOYW1lKSB7XG4gICAgICBhbGVydChgUG9yIGZhdm9yLCBpbnRyb2R1Y2UgdW4gbm9tYnJlIHbDoWxpZG8uYCk7XG4gICAgfVxuICB9IHdoaWxlICghdXNlck5hbWUpO1xuXG4gIC8vIExsYW1hciBhbCBtw6l0b2RvIHBhcmEgaW5zZXJ0YXIgZWwgbm9tYnJlIGVuIGxhIFVJXG4gIHVzZXJJbnRlcmZhY2UuaW5zZXJ0TmFtZSh1c2VyTmFtZSk7XG5cbiAgLy8gR3VhcmRhciBlbCBub21icmUgZW4gZWwgTG9jYWxTdG9yYWdlXG4gIHNhdmVUb0xvY2FsU3RvcmFnZShgdXNlcm5hbWVgLCB1c2VyTmFtZSk7XG59XG5cbmZ1bmN0aW9uIHJlcXVlc3RCdWRnZXQoKSB7XG4gIGNvbnN0IHVzZXJCdWRnZXQgPSBOdW1iZXIocHJvbXB0KGDCv0N1w6FsIGVzIHR1IHByZXN1cHVlc3RvP2ApKTtcbiAgY29uc3Qgdm9pZFZhbHVlID0gYGA7XG5cbiAgaWYgKFxuICAgIHVzZXJCdWRnZXQgPT09IHZvaWRWYWx1ZSB8fFxuICAgIHVzZXJCdWRnZXQgPT09IG51bGwgfHxcbiAgICBpc05hTih1c2VyQnVkZ2V0KSB8fFxuICAgIHVzZXJCdWRnZXQgPD0gMFxuICApIHtcbiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gIH1cblxuICAvLyBDcmVhciBpbnN0YW5jaWEgZGUgXCJCdWRnZXRcIiB5IGVzdGFibGVjZXJsb1xuICBidWRnZXQgPSBuZXcgQnVkZ2V0KHVzZXJCdWRnZXQpO1xuXG4gIC8vIExsYW1hciBhbCBtw6l0b2RvIHBhcmEgaW5zZXJ0YXIgZWwgcHJlc3VwdWVzdG8gZW4gbGEgVUlcbiAgdXNlckludGVyZmFjZS5pbnNlcnRCdWRnZXQoYnVkZ2V0KTtcblxuICAvLyBHdWFyZGFyIGVsIG9iamV0byBkZSBwcmVzdXB1ZXN0byBlbiBlbCBsb2NhbFN0b3JhZ2VcbiAgc2F2ZVRvTG9jYWxTdG9yYWdlKGBidWRnZXRgLCBidWRnZXQpO1xufVxuXG5mdW5jdGlvbiBidWRnZXRGb3JtRXZlbnRzKCkge1xuICAvLyBPYnRlbmVyIGVsIGZvcm11bGFyaW8geSBzdXMgZXZlbnRvc1xuICBjb25zdCBidWRnZXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2J1ZGdldEZvcm1gKTtcbiAgYnVkZ2V0Rm9ybS5hZGRFdmVudExpc3RlbmVyKGBzdWJtaXRgLCBhZGRFeHBlbnNlKTtcbn1cblxuZnVuY3Rpb24gYWRkRXhwZW5zZShlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICAvLyBPYnRlbmVyIGxvcyB2YWxvcmVzIGRlbCBmb3JtdWxhcmlvXG4gIGNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNidWRnZXRGb3JtTmFtZWApLnZhbHVlO1xuICBjb25zdCBpbnB1dEFtb3VudCA9IE51bWJlcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjYnVkZ2V0Rm9ybUFtb3VudGApLnZhbHVlKTtcbiAgY29uc3Qgc2VsZWN0ZWRDYXRlZ29yeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNidWRnZXRGb3JtQ2F0ZWdvcnlgKS52YWx1ZTtcbiAgbGV0IHZvaWRWYWx1ZSA9IGBgO1xuXG4gIC8vIFZhbGlkYXIgcXVlIG5pbmd1bm8gZGUgbG9zIGNhbXBvcyBlc3TDqSB2YWPDrW9cbiAgaWYgKFxuICAgIGlucHV0TmFtZSA9PT0gdm9pZFZhbHVlIHx8XG4gICAgaW5wdXRBbW91bnQgPT09IHZvaWRWYWx1ZSB8fFxuICAgIHNlbGVjdGVkQ2F0ZWdvcnkgPT09IHZvaWRWYWx1ZVxuICApIHtcbiAgICB1c2VySW50ZXJmYWNlLnByaW50QWxlcnRzKGBUb2RvcyBsb3MgY2FtcG9zIHNvbiBvYmxpZ2F0b3Jpb3NgLCBgZXJyb3JgKTtcblxuICAgIHJldHVybjtcbiAgfSBlbHNlIGlmIChpbnB1dEFtb3VudCA8PSAwIHx8IGlzTmFOKGlucHV0QW1vdW50KSkge1xuICAgIHVzZXJJbnRlcmZhY2UucHJpbnRBbGVydHMoYENhbnRpZGFkIG5vIHZhbGlkYWAsIGBlcnJvcmApO1xuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gQ3JlYXIgb2JqZXRvIGNvbiBlbCBnYXN0b1xuICBjb25zdCBleHBlbnNlID0geyBpbnB1dE5hbWUsIGlucHV0QW1vdW50LCBzZWxlY3RlZENhdGVnb3J5LCBpZDogRGF0ZS5ub3coKSB9O1xuXG4gIC8vIEHDsWFkaXIgZWwgZ2FzdG8gYSBsYSBsaXN0YSB5IGFsIHByZXN1cHVlc3RvXG4gIGJ1ZGdldC5uZXdFeHBlbnNlcyhleHBlbnNlKTtcblxuICAvLyBPYnRlbmVyIGxvcyB2YWxvcmVzIGFjdHVhbGVzIGRlbCBwcmVzdXB1ZXN0byB5IGdhc3RvXG4gIGNvbnN0IHsgZXhwZW5zZXMsIGJ1ZGdldEF2YWlsYWJsZSwgYnVkZ2V0U3BlbnQgfSA9IGJ1ZGdldDtcblxuICAvLyBJbXByaW1pciBlbCBnYXN0byBlbiBlbCBIVE1MXG4gIHVzZXJJbnRlcmZhY2Uuc2hvd0V4cGVuc2VMaXN0KGV4cGVuc2VzKTtcblxuICAvLyBBY3R1YWxpemFyIGVsIHByZXN1cHVlc3RvIGVuIGxhIFVJXG4gIHVzZXJJbnRlcmZhY2UudXBkYXRlQXZhaWxhYmxlQnVkZ2V0KGJ1ZGdldEF2YWlsYWJsZSwgYnVkZ2V0U3BlbnQpO1xuXG4gIC8vIExsYW1hciBhbCBtw6l0b2RvIHBhcmEgY29tcHJvYmFyIHNpIHNlIGhhIGFsY2FuemFkbyBlbCBwcmVzdXB1ZXN0b1xuICB1c2VySW50ZXJmYWNlLmNoZWNrQnVkZ2V0KGJ1ZGdldCk7XG5cbiAgLy8gTGltcGlhciBsb3MgY2FtcG9zIGRlbCBmb3JtdWxhcmlvXG4gIGNvbnN0IGJ1ZGdldEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjYnVkZ2V0Rm9ybWApO1xuICBidWRnZXRGb3JtLnJlc2V0KCk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZUV4cGVuc2UoaWQpIHtcbiAgLy8gRWxpbWluYXIgZWwgZ2FzdG8gZGVsIG9iamV0b1xuICBidWRnZXQuZGVsZXRlRXhwZW5zZShpZCk7XG5cbiAgLy8gT2J0ZW5lciBsb3MgdmFsb3JlcyBhY3R1YWxlcyBkZWwgcHJlc3VwdWVzdG8geSBnYXN0b1xuICBjb25zdCB7IGV4cGVuc2VzLCBidWRnZXRBdmFpbGFibGUsIGJ1ZGdldFNwZW50IH0gPSBidWRnZXQ7XG5cbiAgLy8gRWxpbWluYXIgZWwgZ2FzdG8gZGVsIEhUTUxcbiAgdXNlckludGVyZmFjZS5zaG93RXhwZW5zZUxpc3QoZXhwZW5zZXMpO1xuXG4gIC8vIEFjdHVhbGl6YXIgZWwgcHJlc3VwdWVzdG8gZW4gbGEgVUlcbiAgdXNlckludGVyZmFjZS51cGRhdGVBdmFpbGFibGVCdWRnZXQoYnVkZ2V0QXZhaWxhYmxlLCBidWRnZXRTcGVudCk7XG5cbiAgLy8gTGxhbWFyIGFsIG3DqXRvZG8gcGFyYSBjb21wcm9iYXIgc2kgc2UgaGEgYWxjYW56YWRvIGVsIHByZXN1cHVlc3RvXG4gIHVzZXJJbnRlcmZhY2UuY2hlY2tCdWRnZXQoYnVkZ2V0KTtcbn1cblxuZnVuY3Rpb24gc2F2ZVRvTG9jYWxTdG9yYWdlKGtleSwgdmFsdWUpIHtcbiAgLy8gR3VhcmRhciBkYXRvcyBlbiBlbCBMb2NhbFN0b3JhZ2VcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYCR7a2V5fWAsIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG59XG4iXX0=
